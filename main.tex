\documentclass[sigconf]{acmart}


% packages 
\usepackage[ruled,vlined]{algorithm2e}
\usepackage{mathrsfs}
\usepackage{bm}
\usepackage{enumitem}
% new commands and shortcuts
\def\td{{\bf todo}}
\def\bs{\textit{\textbf{s}}}
\def\bz{\textit{\textbf{0}}}
\def\Lb{\textit{\textbf{L}}}
\def\Xb{\textit{\textbf{X}}}
\def\Lambdab{\bm{\Lambda}}
\def\Thetab{\bm{\Theta}}
\def\thetab{\bm{\vartheta}}
\def\mA{{\bm A}}
\def\fA{{\frak A}}
\def\xb{\textit{\textbf{x}}}
\def\fb{\textit{\textbf{f}}}
\def\ab{\textit{\textbf{a}}}
\def\pb{\textit{\textbf{p}}}
\def\ajb{\overline{a_j}}
\def\bjb{\overline{b_{j,l}}}
\def\pjb{\overline{P_{j}}}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\htt}{ht}
\def\C{\mathbb{C}}
\def\pr{\mathbb{P}}
\def\vt{\vartheta}
\def\Q{\mathbb{Q}}
\def\R{\mathbb{R}}
\def\K{\mathbb{K}}
\def\rs{\mathscr{R}}
\def\P{\mathscr{P}}
\def\d{\delta}
\def\sing{ \textrm{sing}}
\def\codim{ \textrm{codim}}
\def\jac{ \textbf{jac}}
\def\exp{\textrm{exp}}
\def\grad{\textrm{grad}}
\def\rank{\textrm{rank}}
\def\reg{\textrm{reg}}
\def\jt{\widetilde{J}}
\def\At{\widetilde{A}}
\def\Yt{\widetilde{Y}}
\def\kt{\widetilde{k}}
\def\dt{s}
%% \def\dt{\widetilde{d}}
\def\Dt{\widetilde{D}}
\def\rk{\textrm{rank }}
\def\pa{\partial}
\def\D{\Delta}
\def\Z{\frak{Z}}
\newcommand{\ZZ}{{\mathbb{Z}}}
\newcommand{\softO}{{O^{\sim}}}
\def\I{\frak{I}}
\def\Is{\frak{I}^{\star}}
\def\A{\frak{A}}
\def\fp{\frak{P}}
\def\sp{\mathscr{P}}
\def\la{\langle}
\def\ra{\rangle}
% matrices 
\def\scrQ{\ensuremath{\mathscr{Q}}}
\def\bbm{\begin{bmatrix}}
\def\ebm{\end{bmatrix}}
%%
%% \BibTeX command to typeset BibTeX logo in the docs
\AtBeginDocument{%
  \providecommand\BibTeX{{%
    \normalfont B\kern-0.5em{\scshape i\kern-0.25em b}\kern-0.8em\TeX}}}

%% Rights management information.  This information is sent to you
%% when you complete the rights form.  These commands have SAMPLE
%% values in them; it is your responsibility as an author to replace
%% the commands and values with those provided to you when you
%% complete the rights form.
\setcopyright{acmcopyright}
\copyrightyear{2020}
\acmYear{2020}
\acmDOI{10.1145/1122445.1122456}

%% These commands are for a PROCEEDINGS abstract or paper.
%\acmConference[ Kalamata, Messinia, Greece '20]{ Kalamata, Messinia, Greece '20: ACM International Symposium on Symbolic and Algebraic Computation}{July 20--23, 2020}{ Kalamata, Messinia, Greece}
\acmBooktitle{ Kalamata, Messinia, Greece '20: ACM International Symposium on Symbolic and Algebraic Computation,  July 20--23, 2020,  Kalamata, Messinia, Greece}
\acmPrice{15.00}
\acmISBN{978-1-4503-XXXX-X/18/06}


\usepackage[ruled,vlined]{algorithm2e}
\usepackage{chngcntr}
\usepackage{titlesec}

\begin{document}

%%
%% The "title" command has an optional parameter,
%% allowing the author to define a "short title" to be used in page headers.
%\title{Bit Complexity for Computation of one Point in each Connected
%Component of a Smooth Real Hypersurface}
\title{On the Bit Complexity of Finding Points in Connected Components of a Smooth Real Hypersurface}

%%
%% The "author" command and its associated commands are used to define
%% the authors and their affiliations.
%% Of note is the shared affiliation of the first two authors, and the
%% "authornote" and "authornotemark" commands
%% used to denote shared contribution to the research.
\author{Jesse Elliott}
\affiliation{%
  \institution{Cheriton School of Computer Science}
  \city{University of Waterloo}
}
\email{jakellio@uwaterloo.ca}

\author{Mark Giesbrecht}
\affiliation{%
  \institution{Cheriton School of Computer Science}
  \city{University of Waterloo}
}
\email{mwg@uwaterloo.ca}

\author{\'Eric Schost}
\affiliation{%
  \institution{Cheriton School of Computer Science}
  \city{University of Waterloo}
}
\email{eschost@uwaterloo.ca}
%%
%% By default, the full list of authors will be used in the page
%% headers. Often, this list is too long, and will overlap
%% other information printed in the page headers. This command allows
%% the author to define a more concise list
%% of authors' names for this purpose.
\renewcommand{\shortauthors}{Elliott, Giesbrecht, and Schost.}

\begin{abstract}
  We present a full analysis of the bit complexity of an efficient
  algorithm for the computation of at least one point in each
  connected component of a smooth real hypersurface. This is a basic
  and important operation in semi-algebraic geometry: it gives an
  upper bound on the number of connected components of a real
  hypersurface, and is also used in many higher level algorithms.
  
  Our starting point is an algorithm by Safey El Din and Schost ({\em
    Polar varieties and computation of one point in each connected
    component of a smooth real algebraic set}, ISSAC'03). This
  algorithm uses random changes of variables, that are proved to
  generically ensure certain desirable geometric properties. The
  complexity of the algorithm was given in an algebraic complexity
  model; the analysis of the bit complexity and the error probability
  were left for future work.

  Our paper answer these questions. Our main contribution is a
  quantitative analysis of several genericity statements, such as
  Thom's weak transversality theorem or Noether normalization
  properties for polar varieties.
\end{abstract}

\begin{CCSXML}
<ccs2012>
 <concept>
  <concept_id>10010520.10010553.10010562</concept_id>
  <concept_desc>Computer systems organization~Embedded systems</concept_desc>
  <concept_significance>500</concept_significance>
 </concept>
 <concept>
  <concept_id>10010520.10010575.10010755</concept_id>
  <concept_desc>Computer systems organization~Redundancy</concept_desc>
  <concept_significance>300</concept_significance>
 </concept>
 <concept>
  <concept_id>10010520.10010553.10010554</concept_id>
  <concept_desc>Computer systems organization~Robotics</concept_desc>
  <concept_significance>100</concept_significance>
 </concept>
 <concept>
  <concept_id>10003033.10003083.10003095</concept_id>
  <concept_desc>Networks~Network reliability</concept_desc>
  <concept_significance>100</concept_significance>
 </concept>
</ccs2012>
\end{CCSXML}


\setcounter{secnumdepth}{4}
\renewcommand{\theparagraph}{\thesubsection.\arabic{paragraph}}
\counterwithin{paragraph}{subsection} % makes paragraph depend on subsection
\titleformat{\paragraph}[runin]{\normalfont\normalsize\bfseries}{\theparagraph.}{1em}{}
\titlespacing*{\paragraph}{0em}{1ex}{1em}
\newcommand{\pref}[1]{{\bf\ref{#1}}}

\keywords{Real algebraic geometry, transversality, Noether
  normalization, bit complexity}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}


\paragraph*{Background and problem statement.}
Computing one point in each connected component of a real algebraic
set $S$ is a basic subroutine in real alebraic and semi-algebraic
geometry; it is also useful in its own right, since it allows one to
decide if $S$ is empty or not. 

In this paper, we consider the case where $S$ is given as $S=V \cap
\R^n$, where $V=V(f) \subset \C^n$ is a complex hypersurface defined
by a squarefree polynomial $f \in \ZZ[X_1,\dots,X_n]$.
Algorithms for this task have been known for decades, and their
complexity is to some extent well understood. Suppose that $f$ has
degree $d$, and coefficients of bit-size $h$. Without making any
assumption on $f$, the algorithm given
in~\cite[Section~13.1]{BaPoRo03} solves our problem using $d^{O(n)}$
operations in $\Q$; in addition, the output of the algorithm is
represented by polynomials of degree $d^{O(n)}$, with coefficients of
bit-size $hd^{O(n)}$.  The key idea behind this algorithm goes back
to~\cite{GrVo88}: sample points are found through the computation of
critical points of well-chosen functions on $V(f)$.

The number of connected components of $V(f)$ admits the lower bound
$d^{\Omega(n)}$, so up to polynomial factors, this result is
optimal. However, due to the generality of the algorithm, the constant
hidden in the exponent $O(n)$ in its runtime turns out to be rather
large: the algorithm relies on infinitesimal deformations, that affect
runtime non-trivially.

In this paper, we will work under the additional assumption that
$V=V(f)$ is a {\em smooth} complex hypersurface. We place ourselves in
the continuation of the line of work initiated by~\cite{BaGiHeMb97}:
that reference deals with cases where $V$ is smooth and $V \cap \R^n$
is compact, pointing out how {\em polar varieties} (that were
introduced in the 1930's in order to define characteristic
classes~\cite{Piene78,Teissier88}) can play a role in effective real
geometry. This paper was extended in several directions: to $V$ being
a smooth complete intersection, still with $V\cap \R^n$
compact~\cite{BaGiHeMb01}, then without the compactness
assumption~\cite{EMP,BaGiHePa05}; the smoothness assumption was then partly
dropped in~\cite{BaGiHe14,BaGiHeLePa12}.

Our starting point is the algorithm in~\cite{EMP}. In the hypersurface
case, its runtime is $d^{(4+o(1))n}$ operations in $\Q$.  As with many
results in this vein, the algorithm is randomized: we need to assume
that we are in generic coordinates; this is done by applying a random
change of coordinates prior to all computations. In addition, the
algorithm relies on procedures for solving systems of polynomial
equations that are themselves randomized.  Altogether, we choose
$n^{O(1)}$ random vectors, each of them in an affine space of
dimension $n^{O(1)}$; every time a choice is made, there exists a
hypersurface of the parameter space that one has to avoid in order to
guarantee success. In this paper, we revisit this algorithm and give a
complete analysis of its probality of success and its bit complexity.

\paragraph*{Data structures.} As in references such
as~\cite{GiHeMoPa95,GiHaHeMoMoPa97,GiHeMoMoPa98,BaGiHeMb97,EMP}, the
input polynomial $f$ is given by means of a {\em straight-line
  program}, that is, a sequence of operations $+,-,\times$ that takes
as input $X_1,\dots,X_n$ and evaluates $f$; the {\em length} of a
straight-line program is simply the number of operations it performs.

Any polynomial of degree $d$ in $n$ variables can be computed by a
straight-line program of length $O\big ({{d+n} \choose n}\big)$:
evaluate all monomials of degree up to $d$ in $n$ variables, multiply
them by their respective coefficients and sum the result. However,
some inputs may be given by shorter straight-line program, and the
algorithm is able to benefit from it.

The output of the algorithm is a finite set in $\overline{\Q}{}^n$. To
represent it, we rely on a widely used data structure based on
univariate
polynomials~\cite{Kronecker82,Macaulay16,GiMo89,GiHeMoPa95,ABRW,GiHaHeMoMoPa97,GiHeMoMoPa98,Rouillier99}.
Consider a zero-dimensional algebraic set $S \subset \C^n$ defined
over $\Q$. A {\em zero-dimensional parametrization}
$\scrQ=((q,v_1,\dots,v_n),\lambda)$ of $S$ consists in polynomials
$(q,v_1,\dots,v_n)$, such that $q\in \Q[T]$ is monic and squarefree,
all $v_i$'s are in $\Q[T]$ and satisfy $\deg(v_i) < \deg(q)$, and in a
$\Q$-linear form $\lambda$ in variables $X_1,\dots,X_n$, such that
\begin{itemize}
\item $\lambda(v_1,\dots,v_n)=T q' \bmod q$;
\item we have the equality
  $S=\left \{\left(
      \frac{v_1(\tau)}{q'(\tau)},\dots,\frac{v_n(\tau)}{q'(\tau)}\right
    ) \ \mid \ q(\tau)=0 \right \}.$
\end{itemize}
The constraint on $\lambda$ says that the roots of $q$ are the values
taken by $\lambda$ on $S$. The parametrization of the coordinates by
rational functions having $q'$ as a denominator goes back
to~\cite{Kronecker82,Macaulay16}: as pointed out in~\cite{ABRW}, it
allows one to control precisely the size of the coefficients of
$v_1,\dots,v_n$.

\paragraph*{Main result.} To state our main result, we need to define 
the {\em height} of a rational number, and of a polynomial with
rational coefficients.

The {\em height} of a non-zero $a=u/v \in \Q$ is the maximum of
$\ln(|u|)$ and $\ln(v),$ where $u \in \mathbb{Z}$ and $v \in
\mathbb{N}$ are coprime. For a polynomial $f$ with rational
coefficients, if $v \in \mathbb N$ is the minimal common denominator
of all non-zero coefficients of $f$, then the \textit{height}
$\htt(f)$ of $f$ is defined as the maximum of the logarithms of $v$
and of the absolute values of the coefficients of $vf$.

\begin{theorem}\label{theo:main}
  Suppose that $f\in\ZZ[X_1\hdots,X_n]$ is squarefree, satisfies
  $\deg(f) \leq d, \htt(f) \leq s$, and that $V(f) \subset \C^n$ is
  smooth.  Assume also that $f$ is given by a straight-line program
  $\Gamma$ of size $L$ with integer constants of height at most $b.$

  There exists a randomized algorithm that takes $\Gamma, d,$ and $s$
  as input and produces a zero-dimensional parameterization of a set
  that contains at least one point in each connected component of
  $V(f) \cap \R^n$ with probability at least $1/2$. Otherwise the
  algorithm either produces a subset of the points or FAIL. In any
  case, the algorithm uses
  \[
  O^{\sim}(k(Lb+d^{2n}(s+d)(L+d)))
  \]
  bit operations, with $k \geq -\lg(1-2^{(-1/n)})$. The polynomials in
  the output have degree at most $d^n,$ and height $
  O^{\sim}((s+d)d^n).$
\end{theorem}
The algorithm itself is rather simple. To describe it, we need to
define {\em polar varieties}, which will play a crucial role in this
paper. Let $V=V(f)$, for $f$ as in the theorem. For $i \in
\{1,\hdots,n-1\},$ denote by $\pi_i:\C^n \rightarrow \C^i$ the
projection $(x_1,\hdots,x_n) \mapsto (x_1,\hdots,x_i)$.  The $i$-th
\textit{polar variety} \[W(\pi_i,V) := \{\xb \in V~|~\dim \pi_i(T_\xb
V) < i\}\] is the set of critical points of $\pi_i$ on $V$.  It is
thus defined by the vanishing of \[f,\frac{\pa f}{\pa
  X_{i+1}},\hdots,\frac{\pa f}{\pa X_n}.\]

In general, we cannot say much about the geometry of
$W(\pi_i,V)$, but if we apply a generic change of coordinates $\mA$,
$W(\pi_i,V)$ is then known to be equidimensional of dimension $(i-1)$
or empty~\cite{BaGiHeMb97}, and to be in so-called {\em Noether
  position}~\cite{EMP} (background notions in algebraic geometry are
in~\cite{Mumford76,Shafarevich77,ECA}; we will recall key
definitions). If this is case, it suffices to choose arbitrary
$\alpha_1,\dots,\alpha_{n-1}$ in $\Q$, and solve the systems defined
by
\begin{equation}\label{eq:syst}
X_1-\alpha_1,\dots,X_{i-1}-\alpha_{i-1}, f, \frac{\pa f}{\pa
  X_{i+1}} ,\dots,\frac{\pa f}{\pa X_n},  
\end{equation}
for $i=1,\dots,n$.  They all admit finitely many solutions, and
Theorem~2 in~\cite{EMP} proves that the union of their solution sets
contains one point on each connected component of $V \cap \R^n$.

Our main contribution is to analyse precisely what conditions on our
change of coordinates $\mA$ guarantee success. This is done by
revisiting the key ingredients in the proofs given
in~\cite{BaGiHeMb97} and~\cite{EMP} and giving quantitative versions
of these results, bounding the degree of the hypersurfaces we have to
avoid.  To solve the equations~\eqref{eq:syst}, we use the algorithm
in~\cite{SH}, for which a complete bit complexity analysis is
available.

This work should be seen as a first step toward the analysis of
further randomized algorithms in real algebraic geometry. An immediate
follow-up question would be to handle the case of algebraic sets
defined by {\em regular sequences}: the algorithm in~\cite{EMP} still
applies, but the modifications needed would take us to far for the
current format. Further yet, randomized algorithms for deciding {\em
  connectivity queries} on smooth, compact algebraic sets have been
developed in a series of papers
\cite{SchostMohabBabySteps2011,SchostMohabBabySteps2014}, and could be
revisited using the techniques introduced here.

%% The \textit{dimension} of an algebraic set $V \subset \C^n$, denoted $\dim V,$ can be defined in the following ways:
%% %
%% \begin{enumerate}
%%     \item The number of generic hyperplanes needed to intersect with $V$ to obtain a finite set. 
%%     \item The Krull Dimension of $\C[X_1,\hdots,X_n]/I(V)$.
%% \end{enumerate}
%% %
%% The \textit{codimension} of $V$ is $n - \dim V$. An algebraic set is \textit{equidimensional} if each irreducible component has the same dimension.  If each component has dimension $d$ then we say it is $d-$equidimensional. 
%% The \textit{degree} of an algebraic set is the number of intersection points between itself and $\dim V$ generic hyperplanes.
%% %
%% \begin{example} 
%% An algebraic set of dimension zero is a finite set, with degree equal to its cardinality.
%% \end{example}
%% %
%% \begin{example}
%% An algebraic set of dimension 1 is a curve, with degree equal to the number of intersection points with a generic hyperplane.
%% \end{example}
%% %
%% %
%% %


%% Let $V \subset \C^n$ be a $d$-equidimensional algebraic set.  The
%% point $x \in V$ is a \textit{regular point} if $\dim (T_xV) = d.$
%% Otherwise $x$ is a \textit{singular point}. We let $\reg(V)$ and
%% $\sing(V)$ respectively denote the regular and singular points of $V$.

%% %
%% \subsubsection{Critical points of polynomial mappings}
%% %
%% Let $\phi : V \rightarrow \C^m$ be a polynomial mapping. A \textit{critical point} of $\phi$ is a regular point of $V$ with $d_x \phi(T_xV) \not = \C^m,$ where $d_x \phi$ is the differential of $\phi$ at $x.$ A \textit{critical} value of $\phi$ is the image of a critical point by $\phi$.
%% %
%% \subsection{The zariski-tangent space}
%% %
%% Denote by $\grad_{\xb}(f)$ the evaluation of the gradient vector of $f$ in $\C[X_1,\hdots,X_n]$ at $\xb$ in $\C$.
%% The \textit{Zariski-tangent space} to $V$ at $\xb \in V$ is the vector space $T_{\xb}V$ defined by the equations $\grad_{\xb}(f) \cdot \textit{\textbf{v}}=0$ for all polynomials $f$ that vanish on $V$. For a polynomial system $\textit{\textbf{f}}=(f_1,\hdots,f_N)$ in $\C[X_1,\hdots,X_n]$, denote by $\jac(\textit{\textbf{f}})$ the Jacobian matrix.
%% The following is a direct consequence of \cite[Corollary 16.20]{ECA}.
%% %
%% \begin{proposition}
%% If $V \subset \C^n$ is a $d$-equidimensional algebraic set with ideal $I(V)=\langle f_1,\hdots,f_N \rangle$, then at any point $\textbf{x}$ of $\reg(V),$ $\jac_\textbf{x}(\textbf{f})$ has full rank $n - \dim(V)$ and the kernel of $\jac_\textbf{x}(\textbf{f})$ is equal to $T_\textbf{x}V.$ 
%% \end{proposition}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Genericity properties}

Consider $f \in \ZZ[X_1,\hdots,X_n]$ with total degree $d$, and assume
that $f$ is squarefree and that $V(f) \subset \C^n$ is smooth. The key
to the proof of Theorem~\ref{theo:main} is the following quantitative
version of facts we stated above, namely that in generic coordinates,
polar varieties are smooth, equidimensional, and in Noether position.

We recall that an equidimensional algebraic set $X \subset \C^n$ of
dimension $d$ is in \textit{Noether position} for the projection
$\pi_d$ when the extension $\C[X_1,\hdots,X_d] \rightarrow
\C[X_1,\hdots,X_n]/I(X)$ is injective and integral; here, $I(X)
\subset \C[X_1,\dots,X_n]$ is the defining ideal of $X$. In this case,
for any $\xb \in \C^d,$ the fiber $X \cap \pi_d^{-1}(\xb)$ has
dimension zero (so it is finite and not empty).

For $i$ in $\{1,\dots,n-1\}$ and $f$ as above, we will let $\I(i, f)$
denote the sequence of $n-(i-1)$ polynomials $(f, {\pa f}/{\pa
  X_{i+1}},\dots,{\pa f}/{\pa X_n})$. As we pointed out in the
introduction, their zero-set is the $i$th polar variety $W(\pi,V(f))$.
Then, we say that $f$ satisfies $\textbf{H}_i$ if
\begin{enumerate}
\item For any $\xb$ in $W(\pi,V(f))$, the Jacobian matrix
  $\jac(\I(i, f))$ has full rank $n-(i-1)$ at $\xb$.

  {\em By the Jacobian Criterion~\cite[Corollary 16.20]{ECA}, this
  implies that $W(\pi_i,V(f))$ is either empty or $(i-1)$-equidimensional.}

\smallskip

\item $W(\pi_i,V(f))$ is either empty or in Noether position for
  $\pi_{i-1}$.
\end{enumerate}
When this holds, given $\bm \alpha = (\alpha_1,\hdots,\alpha_{i-1})$
in $\C^{i-1}$, we further say that $f$ and $\bm \alpha$ satisfy
$\textbf{H}'_i$ if
\begin{enumerate}
\item the $n$ equations
  $(X_1-\alpha_1,\dots,X_{i-1}-\alpha_{i-1}),\I(i, f))$ generate a
  radical ideal.

  {\em By point (2) above, we know that there are finitely many solutions 
    to these equations.}
\end{enumerate}

Even if $f$ does not satisfy $\textbf{H}_i$, we mentioned that it does
after applying a change of variables. The precise statement is the
following; to state it, we use the following notation. For a matrix
$\mA$ in $\C^{n^2}$ and $g$ in $\C[X_1,\hdots,X_n]$ we write
$g^\mA:=g(\mA \Xb) \in \C[X_1,\dots,X_n]$.

%% , $\xb \in
%% \mathbb{C}^n$ and $X \subset \C^n$. We write $\xb^\mA:=\mA^{-1}\xb$,
%% $X^\mA:=\{x^\mA~|~\xb \in V\}$ and $g^\mA:=g(\mA \Xb) \in
%% \C[X_1,\dots,X_n]$. In particular, we have $g^\mA(\xb^\mA) =g(\xb)$,
%% and $V(f)^\mA=V(f^\mA)$.

\begin{theorem}
  There exists a hypersurface $\D \subset \mathbb{C}^{n^2}$ of degree
  at most $\td$ such that, if $\mA$ is chosen from $\C^{n^2}-\Delta$
  then $\mA$ is invertible and $f^\mA$ satisfies $\textbf{H}_i$ for
  all $i \in \{1,\hdots,n-1\}.$
\end{theorem}
%% %
%% \begin{corollary} 
%%   Fix $S \subset \mathbb{Q}$ with $|S| \geq \epsilon^{-1}
%%   D^{\textrm{\td}}$ and $\epsilon > 0$. Then for $A\in S^{n^2}$ chosen
%%   randomly, the probability that $f^A$ satisfies $H_i^{'}$ for all $i
%%   \in \{1,\hdots,n\}$ is at least $1-\epsilon.$
%% \end{corollary}

We will also work with change of variables with ``generic entries''.
For this, we will introduce $n^2$ new indeterminates $(\frak
A_{i,j})_{1\le i,j \le n^2}$, we will let $\K$ be the field $\C(\frak
A_{i,j})_{1\le i,j \le n^2})$, and use the corresponding matrix $ \fA$
over $\K$. For $g$ as above, we will then define the polynomial 
$g^\fA:=g(\fA \Xb) \in \K[X_1,\dots,X_n]$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Weak Transversality and Applications}

Sard's lemma states that the set of critical values of a smooth
function $\R^n \to \R^m$ has measure zero. One can give ``algebraic''
versions of it, for semi-algebraic mappings $\R^n \to \R^m$ as
in~\cite[Chapter~9]{bochnak1998real} or polynomial mappings $\C^n \to
\C^m$ as in~\cite[Chapter~3]{Mumford76}, for which the sets of
critical values are contained in strict semi-algebraic,
resp.\ algebraic sets in the codomain. Thom's weak transversality
lemma, as given for instance in~\cite{demazure2000bifurcations},
generalizes Sard's lemma. In this section, we consider a particular
case of this result (transversality to a point), and establish a
quantitative version of it; this will allow us to establish the first
item in property ${\bf H}_i$, as well as property ${\bf H}'_i$. Our
presentation is inspired by that in~\cite{TWT}.

%% ; it states that if a smooth function
%% $F(\Xb,\Lambda)$, depending on parameters $\Lamdba$ in $\C^s$ is
%% ``transverse'' to a certain submanifold in its domain space, then for
%% most values $\lambda \in \C^s$, $F(\Xb,\lambda)$ remains

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Weak Transversality}

Transversality to a point can be rephrased entirely in terms of
critical and regular values. Recall that if $\bm \Psi$ is a mapping
from a smooth algebraic set $Y$ to $\C^t$, with $t\le \dim(Y)$, a {\em
  critical point} of $\bm \Psi$ is a point $\bm y \in Y$ such that the
image of the tangent space $T_{\bm y} Y$ by the differential $d_{\bm
  Y} \bm \Psi$ has dimension less than $t$. When for instance
$Y=\C^v$, we have $T_{\bm y} Y=\C^v$ and this condition is equivalent
to the Jacobian of $\bm \Psi$ having rank less than $t$ at $\bm y$.  A
{\em regular point} of $\bm \Psi$ is a point on $Y$ that is not
critical. {\em Critical values} are the images of critical points; the
complement of this set are the {\em regular values} (so a regular
value is not necessarily in the image of $\bm\Psi$).

Let $n,\dt,$ and $m$ be positive integers, with $m \le n$, and denote
by $\bm\Phi :\C^n \times \C^{\dt} ~ \rightarrow \C^{m}$ a mapping
defined by polynomials in $\C[\Xb,\Thetab]$, where $\Xb$,
resp.\ $\Thetab$, is a set of $n$, resp.\ $\dt$, indeterminates.  For
$\thetab$ in $\C^{\dt}$, let $\bm\Phi_{\thetab} : \C^n \rightarrow
\C^{m}$ be the induced mapping $\xb\mapsto \bm\Phi(\xb,\thetab)$.  The
transversality result we will need is the following.

\begin{proposition} [Weak transversality]\label{prop:weak_t}
  Suppose that $\bm 0$ is a regular value of $\bm\Phi$. Then there
  exists a hypersurface $\Delta \subset \C^{\dt}$ of degree at most
  \td for which, if $\thetab \in \C^{\dt}-\Delta$, then $\bm 0$ is a
  regular value of~$\bm\Phi_{\thetab}$.
\end{proposition}

Here is a simple example that shows this result at work. Consider a
squarefree $f$ in $\C[X_1,X_2]$, such that $V(f)$ is a smooth curve in
$\C^2$, and let the mapping $\bm\Phi:\C^2\times \C \to \C^2$ be defined
by $\bm\Phi(X_1,X_2,\Lambda) = (f(X_1,X_2), X_1-\Lambda)$. One checks
that the Jacobian of $\bm\Phi$ with respect to $(X_1,X_2,\Lambda)$ has
rank two at any point in $\bm\Phi^{-1}(\bm 0)$, so the assumptions of the
proposition apply. We deduce that for a generic $\lambda$ in $\C$,
that is, for all $\lambda$ in $\C$ except a finite number, the ideal
$(f(X_1,X_2), X_1-\lambda)$ is radical in $\C[X_1,X_2]$; equivalently,
$f(\lambda, X_2)$ is squarefree. We will revisit this example in
Section~\td.

The rest of the section is devoted to the proof of the proposition.
The proof of \cite[Theorem B.3]{TWT} already shows the existence of
$\Delta$; it is essentially the classical proof for smooth
mappings~\cite[Section~3.7]{demazure2000bifurcations}, written in an
algebraic context. In what follows, we revisit this proof,
establishing a bound on the degree of $\Delta$.

We will reuse the following fact proved in~\cite{TWT}.  Put $V =
\bm\Phi^{-1}(0)$ and consider the projection $\pi:(\xb, \thetab) \in
\C^n \times \C^{\dt} \mapsto \thetab \in\C^{\dt}$.  If $V$ is empty,
there is nothing to do, since all values $\thetab$ in $\C^\dt$ satisfy
the conclusion of the theorem. Thus, we assume that $V$ is not
empty. Then, the Jacobian criterion shows that $V$ is
smooth and $(n+ \dt -m)$-equidimensional.

Let $Z$ be the set of critical points of $\pi_{|V}$, and consider its
projection $\pi(Z)$ in $\C^s$. This is the set of critical values of
$\pi_{|V}$; hence, by the algebraic form of Sard's lemma (see
\cite[Theorem~3.7]{Mumford76} for irreducible $V$
and~\cite[Proposition~B.2]{TWT} for general $V$), its Zariski closure
$\overline{\pi(Z)}$ is a strict closed subset of $\C^s$. Now, the
proof of \cite[Theorem B.3]{TWT} shows that if $\thetab \in \C^{\dt}$
is not in $\overline{\pi(Z)}$, then $\bm 0$ is a critical value of
$\bm\Phi_{\thetab}$. Hence, it suffices to prove that $Z$ has degree
at most $d^{m+n}$; this will imply the same degree bound for
$\overline{\pi(Z)}$, and prove our propositon.


We first describe the set $Z$ of critical points of $\pi_{|V}$.  Let
$M$ denote the $(s+m) \times (s+n)$ matrix with entries in
$\C[\Xb,\Thetab]$ given by $M = \jac_{\Xb,\Thetab}(\pi,\bm\Phi)$, that
is,
\begin{align*}
M &= 
\bbm 
\jac_{\Xb,\Thetab}(\pi)\\
\jac_{\Xb,\Thetab}(\bm\Phi) 
\ebm 
=
\bbm 
\textbf{0}_{\dt \times n}\hspace{5mm}\textbf{I}_{\dt} \\
\jac_{(\Xb,\Thetab)}(\bm\Phi)
\ebm.
\end{align*}

\begin{lemma} 
  For $(\xb,\thetab)$ in $V$, the matrix $M$ has full rank $\dt+m$ at
  $(\xb,\thetab)$ if and only if $(\xb,\thetab)$ is a regular point of
  $\pi_{|V}.$
\end{lemma}
\begin{proof}
  Take $(\xb,\thetab)$ on $V$, and let $K(\xb,\thetab)$ be the
  Jacobian matrix $\jac_{(\Xb,\Thetab)}(\bm\Phi)$ at $(\xb,\thetab)$.
  Then, the rank of $M(\xb,\thetab)$ can be written as
  $\textup{rank}(K(\xb,\thetab)) + \textup{rank}([\textbf{0}_{\dt
      \times n}~\textbf{I}_{\dt}] \mid \ker K(\xb,\thetab))$, where
  the latter is the rank of the restriction of $[\textbf{0}_{\dt
      \times n}~\textbf{I}_{\dt}]$ to the nullspace of
  $K(\xb,\thetab)$.

  Since $V$ is smooth, $K(\xb,\thetab)$ has full rank ${\rm codim} (V)
  = m$. On the other hand, the nullspace of $K(\xb,\thetab)$ is the
  tangent space $T_{\xb,\thetab} V$, and
  $\textup{rank}([\textbf{0}_{\dt \times n}~\textbf{I}_{\dt}] \mid
  \ker K(\xb,\thetab))$ is the dimension of $\pi(T_{\xb,\thetab} V)$.
  In other words, the rank of $M(\xb,\thetab)$ is equal to
  $m+\dim(\pi(T_{\xb,\thetab} V))$; this implies the claim in the lemma.
\end{proof}


Therefore, we can characterize the set $Z$ of critical points of
$\pi_{|V}$ as those points satisfying $\bm\Phi(\xb,\thetab)=\bm 0$ and
where all minors of $M$ of order $\dt+m$ vanish. We can describe this
set using fewer equations, by discarding certain minors that are
identically zero. Let indeed $J$ denote the $m \times n$ submatrix of
the Jacobian of $\bm\Phi$ consisting of the first $n$ columns.
\begin{lemma} 
  For $(\xb,\thetab)$ in $V$, $(\xb,\thetab)$ is in $Z$ if and only if
  $J(\xb,\thetab)$ has rank less than $m$.
\end{lemma}
\begin{proof}
Notice 
%
\begin{align*}
M(\xb,\thetab)&= 
\bbm 
\textbf{0}_{\dt \times n} &\textbf{I}_{\dt} \\
J(\xb,\thetab)     &J'(\xb,\thetab)
\ebm,
\end{align*}
where $J'$ consists of the remaining columns of the Jacobian matrix of
$\bm\Phi$.  Then, the rank of the former matrix is equal to the rank
of
\begin{align*}
M(\xb,\thetab)&= 
\bbm 
\textbf{0}_{\dt \times n} &\textbf{I}_{\dt} \\
J(\xb,\thetab)     & \bm 0_{m \times s}
\ebm,
\end{align*}
and the conclusion follows.
\end{proof}
Therefore, the set $Z$ can be defined as the set of all
$(\xb,\thetab)$ in $\C^{n+\dt}$ satisfying $\bm\Phi(\xb,\thetab)=\bm
0$ and where all minors of $J$ of order $m$ vanish. Our next step is
to bound the degree of $Z$. For this, rather than considering minors
of $J$, we will rewrite the condition that $J(\xb,\thetab)$ has rank
less than $m$ as the existence of a non-trivial left kernel element.

For this, we let $\textit{\textbf{L}}=[L_1,\hdots,L_m]$ be new
variables, thought of as Lagrange multipliers, and consider the
``Lagrange polynomials'' $\mathscr{L}_1,\dots,\mathscr{L}_{n}$, with
\[
[\mathscr{L}_1 \cdots \mathscr{L}_{n}]=\textit{\textbf{L}}\cdot J(\xb,\thetab).
\] 
Denote by $\frak{Z} \subset \C^{n+\dt+m}$ the algebraic set defined by
the vanishing of $\mathscr{L}_1,\hdots,\mathscr{L}_{n},$ and
$\bm\Psi$, and by $\frak{Z}'$ the algebraic set
\[
\frak{Z}' := \overline{\frak{Z} - \{(\xb,\thetab,0,\hdots,0) \in \C^{n+\dt+m}~|~(\xb,\thetab,0\hdots,0) \in \frak{Z}\}},
\]
where the bar denotes Zariski closure (we have to remove such points,
since $L_1=\cdots=L_m=0$ is always a trivial solution to the Lagrange
equations). Finally, consider the projection
\begin{align*} 
\mu :~ \C^{n+\dt+m} &\rightarrow \C^{n+\dt}\\
(\xb,\thetab,\bm \ell)~ &\mapsto (\xb,\thetab).
\end{align*}

\begin{lemma}  
  The algebraic set $Z$ is equal to the projection $\mu(\frak{Z}')$.
\end{lemma}
\begin{proof}
  Take $(\xb,\thetab)$ in $Z$. Then, $(\xb,\thetab)$ cancels all
  polynomials $\bm \Phi$, and there exists $\bm
  \ell=(\ell_1,\dots,\ell_m)$, not identically zero, such that
  $(\xb,\thetab,\bm \ell)$ cancels the Lagrange polynomials. This
  implies that $(\xb,\thetab,\bm \ell)$ is in $\frak{Z} -
  \{(\xb',\thetab',0,\hdots,0) \in
  \C^{n+\dt+m}~|~(\xb',\thetab',0\hdots,0) \in
  \frak{Z}\}$, and thus in $\frak{Z}'$. This proves the inclusion
  $Z \subset \mu(\frak{Z}')$.

  Conversely, take an irreducible component $Y$ of $\frak Z'$. We prove 
  that $\mu(Y)$ is contained in $Z$.
  By construction, there exists an open dense subset $Y^o \subset Y$
  such that for any $(\xb,\thetab,\bm \ell)$ in $Y^o$, $\bm \ell$ is
  not identically zero. As a result, $(\xb,\thetab)$ is in $Z$, that
  is, $\mu(Y^o)$ is in $Z$. This implies that its Zariski closure
  $\overline{\mu(Y^o)}$ is in $Z$. Since $\mu(Y)$ is contained in
  $\overline{\mu(Y^o)}$, we have $\mu(Y) \subset Z$. Taking 
  the union over all $Y$, we get $\mu(\frak Z') \subset Z$, as claimed.
\end{proof}
%
\begin{corollary} 
  The degree of $Z$ is at most $d^{m+n}.$
\end{corollary}
\begin{proof}
  The algebraic set $\frak Z$ is defined by $m+n$ equations, all of
  them having degree at most $d$. It follows from B\'ezout's
  Theorem~\cite{H} that $\deg(\frak{Z}) \leq d^{m+n}$, and the same
  upper bound holds for $\deg(\frak{Z}')$. Applying the projection
  $\mu$ yields the result.
\end{proof}



It will sometimes be useful for us use in replace of the matrix $A$, a
matrix representing indeterminants: let $\A$ be an $n \times n$ matrix
of new indeterminates $(\A_{i,j})_{1 \leq i , j \leq n}.$ Define
$f^{\A} \in \mathbb{Q}(\A_{i,j})[\textbf{X}]$ as $f(\A\textbf{X})$ and
$V^\A=V(f^\A).$ It follows from Proposition 5.1, that for a generic $A
\in \C^{n^2},$ $0$ is a regular value of $\Phi_{A}$.  The proof of
\cite[Theorem B.3]{TWT}, which establishes the existence of $\Delta
\subset \C^{n^2},$ applies \textit{Sard's lemma}, which shows that the
critical values of a polynomial mapping are contained in a
hypersurface. It follows from Sard's lemma that, for the matrix of
indeterminants $\A,$ $0$ is a regular value of $\Phi_{\A}.$ Otherwise
it could not be that $0$ is a regular value of $\Phi_A,$ for a generic
$A\in \C^{n^2}.$ The proof is routine and we omit details. It then
follows that
\[
\jac_{\xb}(\Phi_{\A}) = \jac_{\xb}\left(f^{\A}(\xb),\frac{\pa f^{\A}(\xb)}{\pa X_{i+1}},\hdots,\frac{\pa f^{\A}(\xb)}{\pa X_n}\right)
\]
has full rank for all $\xb \in V(f^{\A})$, and thus $f^{\A}$satisfies
$\textbf{H}_i^{'}(1),\textbf{H}_i^{'}(2)$ and $\textbf{H}_i^{'}(3)$ by
the Jacobian criterion \cite[Theorem 16.19]{ECA}. We will rely on this
fact in Section 8.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Application: property $\textbf{H}_i(1)$}

We assume our input polynomial $f$ satisfies \textbf{H} so that $f$ is
squarefree with $V(f) \cap \mathbb{R}^n$ smooth. Thus, by Proposition
2.4, $W(\pi_i,V(f))$ is defined by the vanishing of $f,\frac{\pa
  f}{\pa X_{i+1}},\hdots,\frac{\pa f}{\pa X_n}.$ If the Jacobian of
this set of polynomials has full rank at all $\xb \in V(f) \cap
\mathbb{R}^n,$ then it follows by the Jacobian criterion \cite[Theorem
  16.19]{ECA} that $f$ satisfies
$\textbf{H}_i^{'}(1),\textbf{H}_i^{'}(2)$ and $\textbf{H}_i^{'}(3)$.
%
\begin{theorem}
There exists a Zariski closed set $\Delta_1 \subset \C^{n^2}$ of degree at most $d^{2n^2}$ with the property that, if $A \in \C^{n^2} - \Delta_1$ then for each $i \in \{1,\hdots,n\},$ $f^A$ satisfies $\textbf{H}_i^{'}(1),\textbf{H}_i^{'}(2)$ and $\textbf{H}_i^{'}(3)$.
\end{theorem}

For each $i \in \{1,\hdots,n\}$, let $\Phi_i$ be the polynomial mapping 
\[
\Phi_i : (\xb,A) \mapsto \left(f^A(\xb), \frac{\partial f^A}{\partial X_{i+1}}(\xb),\hdots,\frac{\partial f^A}{\partial X_n}(\xb)\right),
\] 
so that $\Phi_{i,A}^{-1}(0)= W(\pi_i,V^A).$ We want to apply Theorem 5.1, and thus we show that $\bz$ is a regular value of $\Phi_i$, where then it follows that $\Xi_i \subset \C^{n^2}$ exists with the property that if $A \in \C^{n^2}-\Xi_i$ then  
\[
\jac_{\xb}(\Phi_{i,A}) = \jac_{\xb}\left(f^A(\xb),\frac{\pa f^A(\xb)}{\pa X_{i+1}},\hdots,\frac{\pa f^A(\xb)}{\pa X_n}\right)
\]
has full rank at all $\xb \in V(f^A)~(\cap\R^n$?). Then, by the Jacobian criterion \cite[Theorem 16.19]{ECA}, $f^A$ satisfies $\textbf{H}_i^{'}(1),\textbf{H}_i^{'}(2)$ and $\textbf{H}_i^{'}(3)$. To obtain the result for all $i \in \{1,\hdots,n\}$, we take 
\[
\Delta_1 = \bigcup_{i=1}^n \Xi_i 
\]
where we can bound the degree by observing that 
\[
\deg \Delta_1 \leq \sum_{i=1}^n \deg \Xi_i.
\]


Fix $i \in \{1,\hdots,n\}$, and let $\Phi_i$ be as stated above.
%
\begin{proposition} 
$\bz$ is a regular value of $\Phi_i$.
\end{proposition}
%
\begin{proof}
Let $A_1,\hdots,A_n$ denote the columns of $A,$ and let $(\xb,A) \in \C^n \times \C^{n^2}$ be such that 
$f^A(\xb) = \frac{\partial f^A(\xb)}{\partial X_{i+1}}=\hdots= \frac{\partial f^A(\xb)}{\partial X_n}=\bz.$
We want to show that the Jacobian of the system of polynomials 
\[
f(A\xb),(\grad(f)\cdot A_{i+1})(A\xb),\hdots, (\grad(f)\cdot A_n)(A\xb)
\]
at $(\xb,A)$ has full rank, which holds if and only if the Jacobian of the system of polynomials 
\[
f,\grad(f)\cdot A_{i+1},\hdots, \grad(f)\cdot A_n
\]
at $(\xb,A)$ has full rank. Let $\Psi_i$ be the mapping
%
\begin{align*}
    \Psi_i: \C^n \times \C^{n^2} &\rightarrow \C^{n-i+1} \\
       (\xb,A) &\mapsto 
       \left(f(\xb),\grad(f(\xb))\cdot 
A_{i+1},\hdots
\grad(f(\xb))\cdot 
A_{n}
\right).
\end{align*}
%
For all $(\xb,A) \in \Psi_i^{-1}(0),$ the Jacobian matrix of $\Psi_i$ at $(\xb,A)$ has full rank $n-i+1$. Indeed, set 
\[
F_j = \frac{\pa f}{\pa X_1} a_{i+j,1} + \hdots + \frac{\pa f}{\pa X_n}a_{i+j,n}, ~1 \leq j \leq n-i,
\]
so that the Jacobian is equal to
\[
\left[ 
\begin{array}{cccccc}
\frac{\pa f}{\pa X_1} \hdots \frac{\pa f}{\pa X_n}            &0\hdots 0&\hdots& 0 \hdots 0                                         & \hdots & 0\hdots 0 \\ 
\frac{\pa F_{1}}{\pa X_1}\hdots \frac{\pa F_{1}}{\pa X_n}     &0\hdots 0&\hdots& \frac{\pa f}{\pa X_1} \hdots \frac{\pa f}{\pa X_n} & \hdots & 0\hdots 0 \\
\ddots                                                        &0\hdots 0&\ddots&\ddots                                              & \ddots & \ddots \\
\frac{\pa F_{n-i}}{\pa X_1}\hdots \frac{\pa F_{n-i}}{\pa X_n} &0\hdots 0&\hdots&0 \hdots 0&  \hdots & \frac{\pa f}{\pa X_1} \hdots \frac{\pa f}{\pa X_n}  
\end{array}
\right]. 
\] 
Since $f$ is square-free, $I(V(f)) = \langle f \rangle.$ Therefore, for all $\xb \in V(f)$, 
\[
T_{\xb} V(f) = \textrm{Nullspace}(\grad_{\xb} f).
\]
Since $V(f)$ is smooth, $T_{\xb} V(f)$ has dimension $n-1$ and one partial vanishes. At least one partial of $f$ must be non-zero. Since  $\frac{\pa f}{\pa X_1} \hdots \frac{\pa f}{\pa X_n}$ appears in $n-i+1$ rows, the matrix has full rank $n-i+1$.
\end{proof}
%
Since $\deg \Phi_i \leq d,$ it follows by Theorem 5.1 that a hypersurface $\Xi_i \subset \C^{n^2}$ exists, of degree at most $d^{n+(n-i+1)}=d^{2n-i+1}\leq d^{2n},$ with the property that, if $A \in \C^{n^2}-\Xi_i,$ then 
%
\[
 \jac_\xb \left(f^A,\frac{\pa f^A}{\pa X_{i+1}},\hdots,\frac{\pa f^A}{\pa X_n}\right)
\]
has full rank for all $\xb \in V(f^A)$ ($\cap \R^n$?), so that  $f^A$ satisfies $\textbf{H}_i^{'}(1),\textbf{H}_i^{'}(2)$ and $\textbf{H}_i^{'}(3)$ by the Jacobian criterion \cite[Theorem 16.19]{ECA}. Now, to prove the claim for all $i \in \{1,\hdots,n\},$ we take
\[
\Delta_1 := \bigcup_{i=1}^n \Xi_i,
\]
where we have the following bound on the degree which proves the claim:
\[
\deg \Delta_1 \leq \sum_{i=1}^n \deg \Xi_i  \leq d^{2n^2}.
\] 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Application: property $\textbf{H}'_i$}

\begin{theorem}
  There exists a Zariski closed set $\Delta_2 \subset \C^{n^2}$ of
  degree at most $\td$ with the property that, if $A \in \C^{n^2} -
  \Delta_2$ then for each $i \in \{1,\hdots,n\},$ $f^A$ satisfies
  $\textbf{H}_i'(4),\textbf{H}_i'(5)$ and $\textbf{H}_i'(6)$.
\end{theorem}

Let $p_{n-1} = (\alpha_1,\hdots,\alpha_{n-1}) \in \Q^{n-1}$ be a randomly chosen point. For $i \in \{1,\hdots,n\}$, we want to show that the Jacobian of the system of polynomials
\[
X_1(\xb)-\alpha_1,\hdots,X_{i-1}(\xb)-\alpha_{i-1}, f(\xb),  \frac{\pa f(\xb)}{\pa X_{i+1}},\hdots,\frac{\pa f(\xb)}{\pa X_n}
\]
has full rank, at all points $(\xb,A) \in \C^n \times \C^{n^2}$ in the zero set of this system. It would then follow from Theorem 5.1 that a hypersurface  exists with the desired properties. 

Let $\Phi_i$ be the mapping 
%
\begin{align*}
    \Phi_i: \C^n \times \C^{i-1} &\rightarrow \C^{n} \\
           (\xb,\alpha_1,\hdots,\alpha_{i-1}) &\mapsto 
       (X_1(\xb)-\alpha_1,\hdots \\
       \hdots &,X_{i-1}(\xb)-\alpha_{i-1}, f(\xb),\frac{\pa f(\xb)}{\pa X_{i+1}},\hdots,\frac{\pa f(\xb)}{\pa X_n} ).
\end{align*}
%
\begin{proposition}
$\bz$ is a regular value of $\Phi_i.$
\end{proposition} 
\begin{proof}
For all $(\xb,A) \in \Phi_i^{-1}(0),$ the Jacobian matrix of $\Phi_i$ at $(\xb,A)$ has full rank $\td$. Indeed, the Jacobian is equal to
%% \[
%% \left[ 
%% \begin{array}{cccccc}
%% \frac{\pa f}{\pa X_1} \hdots \frac{\pa f}{\pa X_n}            &0\hdots 0&\hdots& 0 \hdots 0                                         & \hdots & 0\hdots 0 \\ 
%% \frac{\pa F_{1}}{\pa X_1}\hdots \frac{\pa F_{1}}{\pa X_n}     &0\hdots 0&\hdots& \frac{\pa f}{\pa X_1} \hdots \frac{\pa f}{\pa X_n} & \hdots & 0\hdots 0 \\
%% \ddots                                                        &0\hdots 0&\ddots&\ddots                                              & \ddots & \ddots \\
%% \frac{\pa F_{n-i}}{\pa X_1}\hdots \frac{\pa F_{n-i}}{\pa X_n} &0\hdots 0&\hdots&0 \hdots 0&  \hdots & \frac{\pa f}{\pa X_1} \hdots \frac{\pa f}{\pa X_n}  
%% \end{array}
%% \right]. 
%% \] 
Since $f$ is square-free, $I(V(f)) = \langle f \rangle.$ Therefore, for all $\xb \in V(f)$, 
\[
T_{\xb} V(f) = \textrm{Nullspace}(\grad_{\xb} f).
\]
Since $V(f)$ is smooth, $T_{\xb} V(f)$ has dimension $n-1$ and one partial vanishes. At least one partial of $f$ must be non-zero. Since  $\frac{\pa f}{\pa X_1} \hdots \frac{\pa f}{\pa X_n}$ appears in $n-i+1$ rows, the matrix has full rank $n-i+1$.
\end{proof}
%
Since $\deg \Phi_i \leq D,$ it follows by Theorem 5.1 that a hypersurface $\Xi_i \subset \C^{n^2}$ exists, of degree at most $D^{n+(n-i+1)}=D^{2n-i+1}\leq D^{2n},$ with the property that, if $A \in \C^{n^2}-\Xi_i,$ then 
%
\[
 \jac_\xb \left(f^A,\frac{\pa f^A}{\pa X_{i+1}},\hdots,\frac{\pa f^A}{\pa X_n}\right)
\]
has full rank for all $\xb \in V(f^A)$ ($\cap \R^n$?), so that  $f^A$ satisfies $\textbf{H}_i^{'}(1),\textbf{H}_i^{'}(2)$ and $\textbf{H}_i^{'}(3)$ by the Jacobian criterion \cite[Theorem 16.19]{ECA}. Now, to prove the claim for all $i \in \{1,\hdots,n\},$ we take
\[
\Delta_1 := \bigcup_{i=1}^n \Xi_i,
\]
where we have the following bound on the degree which proves the claim:
\[
\deg \Delta_1 \leq \sum_{i=1}^n \deg \Xi_i  \leq D^{2n^2}.
\] 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Property ${\bf H}_i(2)$ -- Noether position}

Throughout this section, we consider that $i \in \{1,\hdots,n\}$ is
fixed. We prove that there exists a hypersurface $\D_{3,i} \subset
\C^{n^2}$ such that if $\mA$ is not in $\D_{3,i}$, then $\mA$ is
invertible and satisfies $\textbf{H}_i(1)$ and $\textbf{H}_i(2)$.


Let $\A$ be an $n \times n$ matrix of new indeterminates
$(\A_{i,j})_{1 \leq i , j \leq n}.$ Define $f^{\A} \in
\mathbb{Q}(\A)[\textbf{X}]$ as $f(\A\textbf{X})$ and $V^\A=V(f^\A).$
Recall from Section 4.1.4 that $f^\A$ satisfies
$\textbf{H}_i^{'}(1),\textbf{H}_i^{'}(2),$ and $\textbf{H}_i^{'}(3).$
, to simplify notation, let $\I^\A$ denote
$\I(\pi_i,V^\A)$ and let $W^\A$ denote $W(\pi_i,V^\A).$ Furthermore,
throughout this section, We will avoid writing $i$ where the context is clear.
%
\subsection{Sketch of the proof}
%
Let $f \in \mathbb{Q}[X_1,\hdots,X_n]$ have total degree $D$. Assume $f$ satisfies \textbf{H}, so that $f$ is squarefree with $V(f)$ smooth. Recall $\textbf{H}_i^{'}(7):$ \textit{$W(\pi_i,V)$ is in Noether position for $\pi_{i-1}$}, which is equivalent to having the extension  

\[
\C[\textbf{X}_{\leq i-1}]\rightarrow\C[\textbf{X}]/\frak{I}(\pi_i,V)
\]
injective and  integral.
%
\begin{theorem}
There exists a hypersurface $\Delta_3 \subset \C^{n^2}$ of degree at most $\td$ with the property that, if $A \in \C^{n^2} - \Delta_3$ then, for each $i \in\{1,\hdots,n\}, f^A$ satisfies $\textbf{H}_i'(7)$.
\end{theorem}
%
Section 7 is devoted to proving Theorem 7.1. It has already been shown in \cite{EMP} that $f^A$ satisfies $\textbf{H}_i^{'}(7)$ for a generic change of variables. The new contribution is in upper bounding the degree of $\Delta_3.$
%
\begin{proposition} 
The ring extension \[\mathbb{Q}(\frak{A})[\textbf{X}_{\leq i-1}]\rightarrow\mathbb{Q}(\frak{A})[\textbf{X}]/\I^{\A}\] is integral.
\end{proposition}
%
\begin{proof}
Let $(\frak{P}_l)_{l \leq L}$ be the prime components of the radical ideal $\I^\A$. By \cite[Proposition 1]{EMP}, 
\[
\mathbb{Q}(\frak{A})[\Xb_{\leq i-1}]\rightarrow\mathbb{Q}(\frak{A})[\Xb]/\fp_l^{\A}
\] 
is integral. Therefore polynomials $p_{l,j}\in\mathbb{Q}(\frak{A})[\Xb_{\leq i-1}][T]$ exist, monic in $T$, with $p_{l,j}(X_j)\in \frak{P}_l$ for each $j\in \{i,\hdots,n\}.$ Thence, 
%
\begin{align*}
&P_{j}(X_j) := \prod_l p_{l,j}(X_j)\in\I^\A, 
\end{align*}
%
for each $j \in \{i,\hdots,n\},$ and therefore 
\[
\mathbb{Q}(\frak{A})[\Xb_{\leq i-1}]\rightarrow\mathbb{Q}(\frak{A})[\Xb]/\I^{\A}
\] 
is integral.
\end{proof}
%
Let $P_{j} \in \mathbb{Q}(\frak{A})[\Xb_{\leq i-1}][T]$ be as in the proof of Proposition 7.2. Since $P_{j}(X_j) \in\I^{\A}= \langle f^\A,\frac{\partial f^\A}{\partial X_{i+1}},\hdots,\frac{\partial f^\A}{\partial X_n} \rangle,$
 we can write
\[
P_{j}(X_j) = a_j f^{\A} + \sum_{l=1}^{n-i}b_{j,l} \frac{\partial f^\A}{\partial X_{i+l}}, ~a_j,b_{j,l} \in \mathbb{Q}(\A)[\textbf{X}].
\]
For each $P_j,$ there exists a Zariski open set $\Gamma_j \subset \C^{n^2}$ such that if $A \in \Gamma_j$,
then $A$ cancels none of the denominators of $a_{j}$ or $b_{j,l}$. Define $h_j \in \Q[\A]$ to be the product of the denominators of the coefficients of $a_j$ and $b_{j,l}$. Hence, if $A \in \Q^{n^2}-V(h_j)$ then $A$ cancels none of the denominators of $a_{j}$ or $b_{j,l},$ which are providing the integral dependence relation. Now we define 
\[
\Xi_i := \bigcup_{j=i}^n V(h_j) =V\left(\prod_{j=i}^n h_j \right), 
\]
and we obtain a bound on the degree of $\Xi_i$ by observing that
\[
\deg \Xi_i \leq \sum_{j=i}^n \deg h_j.
\]
Hence, if $A\in \Q^{n^2}-\Xi_i$ then
\[
P_j(X_j) \in \I^A,  
\]
for each $j \in \{i,\hdots,n\},$ and therefore the extension 
\[
\mathbb{C}[{\Xb}_{\leq i-1}]\rightarrow\mathbb{C}[\Xb]/\I(\pi_i,V^{A})
\]
is integral. We can obtain bounds for $h_j$ by applying an effective Nullstellensatz theorem. However, the theorem requires $P_{j}$ to be a polynomial. We can obtain a polynomial from $P_{j}$ by clearing denominators. We can multiply $P_{j}$ by the least common multiple of its denominators, which we will denote by $d_j \in \Q[\A_{i,j}]$. Put 
\[
\overline{P_{j}} := d_jP_{j}\in \Q[\A][\Xb],
\]
and note that $\pjb(X_j) \in \I^{\A}$ with 
\[
\pjb(X_j) = \ajb f^{\A} + \sum_{l=1}^{n-i}\bjb \frac{\partial f^\A}{\partial X_{i+l}}, ~\ajb,\bjb \in \mathbb{Q}[\A][\textbf{X}].
\]
%
\begin{proposition} 
$\deg \pjb\leq (D+1)^{n-i+1}.$ 
\end{proposition} 
%
\begin{proof}
\textbf{Eric and Mark}: I am unsure of how to do this part correctly, so I will assume 
\[
\deg \pjb\leq \Dt_j.
\]
Let $\Is \subset \Q[\A,\Xb]$ be the extension of $\I^{\A}$ in  $\Q[\A,\Xb],$ and consider the finite field extension
%
\begin{align*}
    \Q(\A,\Xb_{i-1}) &\rightarrow \Q(\A,\Xb_{i-1})[X_i,\hdots,X_n]/\Is.
\end{align*}
%
The minimal polynomial of the linear mapping defined by multiplication by $X_j$ in $\Q(\A,\Xb_{i-1})$ is \textbf{almost}(?) equal to $\pjb$ (the leading coefficient of $\pjb$ is $d_j$). It therefore follows by \cite[Proposition 1]{CGR} that
%
\begin{align*}
&\deg \pjb \leq (D+1)^{n-i+1}.&(2D)^{n-i+1}\textrm{?} 
\end{align*}
%
\end{proof}
%
Note that 
\[
\deg d_j \leq \deg \pjb \leq \Dt_j.
\]
%
\subsection{Applying the effective Nullstellensatz}
%
To apply the effective Nullstellensatz theorem, we first need to determine degree bounds, separately in $\Xb$ and $\A,$ of the polynomials in the membership relationship. We have
\[
\deg_{\Xb}\left\{ 
f^\A,\frac{\partial f^\A}{\partial X_{i+1}},\hdots,\frac{\partial f^\A}{\partial X_n}
\right\}\leq D,
\]
\[
\deg_{\A}  
\left\{ 
f^\A,\frac{\partial f^\A}{\partial X_{i+1}},\hdots,\frac{\partial f^\A}{\partial X_n}
\right\} \leq D,
\]
\[
\deg_{\Xb,T}(1-T\pjb) \leq \Dt_j +1 
\]
and
\[
\deg_{\A}(1-T\pjb) \leq \Dt_j.
\]
For each $j \in \{i,\hdots,n\},$ by \cite[Theorem 0.5]{EN}, there exists $\alpha_j \in \mathbb{Q}[\A]\setminus\{0\}$ with 
%
\begin{align*}
\alpha_j = \sum_{l=1}^{n-i+1} A_{j,l}(\A,\Xb,T)g_l + B_j(\A,\Xb,T)(1-\pjb T), \\ g_l \in 
\left\{ 
f^\A,\frac{\partial f^\A}{\partial X_{i+1}},\hdots,\frac{\partial f^\A}{\partial X_n}
\right\},~ A_{j,l},B_j \in \mathbb{Q}[\A][\Xb][T],
\end{align*}
%
and with the degree of $\alpha_j$ upper bounded by
%
\begin{align*}
    &\left(\prod_{k=1}^{n-i+1} D\right)\Dt_j 
    + (n-i+1)\left(\Dt_j+1\right)\left(\prod_{k=1}^{n-i}D \right)D\\
    = &\left(D^{n-i+1}\right)\Dt_j+
    (n-i+1)\left(\Dt_j+1\right)\left(D^{n-i+1} \right)\\
    &\leq D^{n}\Dt_j + n\left(\Dt_j+1\right)D^{n}\\
    &=D^n\left(\Dt_j + n\left(\Dt_j+1\right) \right).
\end{align*}
%
Now we will show that $\alpha_j$ is the only remaining denominator whose degree we need to bound. Substitute $T \leftarrow 1/\pjb$ so that 
\[
\alpha_j = \sum_{l=1}^{n-i+1} A_{j,l}(\A,\Xb,1/\pjb)g_l + 0
\]
and
%
\begin{align*}
A_{j,l}(\A,\Xb,1/\pjb) 
&= \sum_{i=1}^{n_l} A_{j,l,i}(\A,\Xb,1/\pjb)\\
&= \sum_{i=1}^{n_l} \left(\frac{1}{P_j^{k_i}}\right)\At_{j,l,i}(\A,\Xb), ~k_i \in \mathbb{Z}.
\end{align*}
%
Let $K := \max\{k_l\}$ so that 
%
\begin{align*}
    \pjb^K \alpha_j &= \pjb^K\left(\sum_{l=1}^{n-i+1} A_{j,l}(\A,\Xb,1/\pjb)g_l\right)\\
    &= \sum_{l=1}^{n-i+1}\left( \sum_{i=1}^{n_l}\left(\pjb^{K-k_{i}}\right)\At_{j,l,i}(\A,\Xb) \right)g_l \in \Q[\A][\Xb].
\end{align*}
%
which shows that $\alpha_j$ is the only remaining denominator whose degree we need to bound other than $d_j$. Note as well that
\[
\pjb^K \in \I^{\A}.
\]
Therefore 
%
\begin{align*}
\deg h_j &\leq \left(\deg \alpha_j\right)\left(\deg d_j\right)\\
    &\leq \left(D^n\left(\Dt_j + n\left(\Dt_j+1\right) \right)\right)\Dt_j\\
    &=D^n\Dt_j\left(\Dt_j + n\left(\Dt_j+1\right) \right).
\end{align*}
%
\subsection{Proof of Theorem 7.1}
%
Now we obtain
%
\begin{align*}
    \deg \Xi_i 
    &\leq \sum_{j=i}^n \deg h_j\\
    &\leq  \sum_{j=i}^n \left( D^n\Dt_j\left(\Dt_j + n\left(\Dt_j+1\right) \right) \right) \\
    &=  (n-i+1)\left( D^n\Dt_j\left(\Dt_j + n\left(\Dt_j+1\right) \right) \right)\\
    &\leq  n D^n\Dt_j\left(\Dt_j + n\left(\Dt_j+1\right) \right) .
\end{align*}
%
And therefore,  
%
\begin{align*}
    \deg& \Delta_3 \leq \sum_{i=1}^n \deg \Xi_i\\
    &\leq n^2 D^n\Dt_j\left(\Dt_j + n\left(\Dt_j+1\right) \right),
\end{align*}
%
where if $A \in \C^{n^2} - \Delta_3$ then, for each $i \in \{1,\hdots,n\},$ the extension 
\[
\C[\textbf{X}_{\leq i-1}]\rightarrow\C[\textbf{X}]/\frak{I}(\pi_i,V^A)
\]

is integral.
%
%
%
%
\section{Proof of Theorem 3.1}
%
Recall Theorem 3.1: \textit{Suppose that $f \in \Q[X_1,\hdots,X_n]$ satisfies \textbf{H}. Then there exists a Zariski closed set $\D \subset \mathbb{C}^{n^2}$ of degree at most $D^{\textrm{\td}}$ such that, if $\textbf{A}$ is chosen from  $\C^{n^2}-\Delta$ ( $\Q^{n^2}-\Delta$?) then $f^A$ satisfies $\textbf{H}_i^{'}$ for all $i \in \{1,\hdots,n\}.$} 
%
\begin{proof}
Assume that $f\in \Q[X_1,\hdots,X_n]$ has degree at most $D$ and satisfies $\textbf{H}.$ By Theorem 5.1, there exists a Zariski closed set $\D_1\subset \C^{n^2}$ with the property that, if $A \in \C^{n^2}-\D_1$ then, for $i \in \{1,\hdots,n\},$ $f^A$ satisfies $\textbf{H}_i^{'}(1), \textbf{H}_i^{'}(2),$ and $\textbf{H}_i^{'}(3).$ Likewise, by Theorem 6.1, we obtain $\D_2 \subset \C^{n^2}$ with the property that if $A \in \C^{n^2}-\D_2$ then $f^A$ satisfies $\textbf{H}_i^{'}(4), \textbf{H}_i^{'}(5),$ and $\textbf{H}_i^{'}(6).$ By Theorem 7.1, $\D_3 \subset \C^{n^2}$ exists with $f^A$ satisfying $\textbf{H}_i^{'}(7)$ when $A \in \C^{n^2}-\D_3$. Clearly then, if 
\[
A \in \C^{n^2} - \bigcup_{i=1}^3 \D_i
\]
then $f^A$ satisfies  $\textbf{H}_i^{'}$ for all $i \in \{1,\hdots,n\}.$ Take 
\[
\Delta = \bigcup_{i=1}^3 \D_i,
\]
and note that 
\[
\deg \D \leq  \sum_{i=1}^3 \deg \D_i.
\]
\end{proof}
%
Recall Corollary 3.2: \textit{Fix $S \subset \mathbb{Q}$ with $|S| \geq \epsilon^{-1} D^{\textrm{\td}}$ and $\epsilon > 0$. Then for $A\in S^{n^2}$ chosen randomly, the probability that $f^A$ satisfies $H_i^{'}$ for all $i \in \{1,\hdots,n\}$ is at least $1-\epsilon.$}
%
\begin{proof}
\[
Pr[A \in \Delta] \leq \frac{\deg \Delta}{|S|} \leq \frac{D^{\td}}{\epsilon^{-1}D^{\td}} = \epsilon.
\]
\end{proof}
%
%
%
%
\section{Bit complexity}
%
Recall Theorem 1.1: Suppose that $f\in\ZZ[X_1\hdots,X_n]$ is squarefree, satisfies
  $\deg(f) \leq d, \htt(f) \leq s$, and that $V(f) \subset \C^n$ is
  smooth.  Assume also that $f$ is given by a straight-line program
  $\Gamma$ of size $L$ with integer constants of height at most $b.$

  There exists a randomized algorithm that takes $\Gamma, d,$ and $s$
  as input and produces a zero-dimensional parameterization of a set
  that contains at least one point in each connected component of
  $V(f) \cap \R^n$ with probability at least $1/2$. Otherwise the
  algorithm either produces a subset of the points or FAIL. In any
  case, the algorithm uses
  \[
  O^{\sim}(k(Lb+d^{2n}(s+d)(L+d)))
  \]
  bit operations, with $k \geq -\lg(1-2^{(-1/n)})$. The polynomials in
  the output have degree at most $d^n,$ and height $
  O^{\sim}((s+d)d^n).$
  
Recall as well that the algorithm can error on one side by producing a proper subset of the points. Running the algorithm $\kt$ times gives a list of $n$ zero-dimensional parameterizations, among which the highest cardinality output includes at least one point in each connected component with probability at least $1-(1/2)^{\kt}.$
%
\subsection{The Algorithm}
%
For a matrix $A \in \GL(n,\Q),$ let 
\[
Y_i = X_i^{A} = [b_i] \cdot \bbm X_1\\ \vdots \\ X_n \ebm, 
\]
where $b_i$ is the i-th row of $A^{-1}$.
%
\begin{algorithm}[hbt!]
\KwIn{a strait line program $\Gamma$ that computes $f \in \Q[X_1,\hdots,X_n],$ and $d=\deg(f)$}
\KwOut{$n$ zero-dimensional parameterizations, whose reunion includes at least one point in each connected component of $V(f) \cap \R^n$}
\nl Choose $S \subset \mathbb{Q}$ and $A \in S^{n^2}$ with $|S|\geq \epsilon^{-1}d^{\td}$, where $\epsilon < 5/21$\;
\nl Compute $f$ and apply the change of variables to obtain $f(A x)=f^A(x)$\;
\nl Use \cite{partialDerComputation} to compute the partial derivatives $\frac{\pa f^A}{\pa X_{i+1}},\hdots,\frac{\pa f^A}{\pa X_n}$\;
    \caption{{Main Algorithm} \label{}}
\nl Randomly choose a point $p_{n-1}=(\alpha_1,\hdots,\alpha_{n-1}) \in \Q^{n-1}~(p_0$?)\; 
\nl \For{$i\gets1$ \KwTo $n$}{
\nl Run \cite[Algorithm 2]{SH} $k > -\lg(1-2^{(-1/n)})$ times with input 
$\{Y_1-\alpha_1,\hdots,Y_{i-1}-\alpha_{i-1},f^A,\frac{\pa f^A}{\pa X_{i+1}},\hdots,\frac{\pa f^A}{\pa X_n} \} \textrm{ and } d$\;
\nl Let $\mathscr{Q}_i$ be the highest cardinality zero-dimensional parameterization returned in step 6 \;
} 
\nl \Return $[\mathscr{Q}_1,\hdots,\mathscr{Q}_n]$.
\end{algorithm}

%
\subsection{Proof of Theorem 1.1}
%
\textbf{Bit operation cost:} The following lists the costs for each step of Algorithm 1:
%
\begin{enumerate}
    \item By our assumption on the size of $S$ we know that $|S| = \log (\epsilon^{-1}D^{\td}) \leq \td.$ Thus for $a_{ij} \in S$ we know that $|a_{ij}| \leq \td.$
    \item 
    \begin{enumerate}[label=\roman*.]
        \item $O(L)$ operations are required to compute $f$ from its straight line program $\Gamma.$
        \item After applying the change of variables obtaining $f(A x)=f^A(x)$ the height grows at most by a factor of
        \begin{align*}
        \log(n!\cdot \max_{\frac{1\leq i\leq n}{1\leq j\leq n}}\{a_{ij}\}) &= 
        O(n\log n + n\log(d+1)) \\
        &= 
        O^\sim(\log(d+1)).
        \end{align*}
    \end{enumerate}
    \item After computing the partial derivatives the height grows by at most another factor of $\log d$. Furthermore, preparing the straight line program for the gradient of $f$ does not introduce large integers. The integers in $\grad (f)$ are of the same magnitude as in $\Gamma$.
    \item $\td$
    \item 
    After applying \cite[Algorithm 2]{SH} $kn$ times, we obtain the
    following upper bound on the total number of bit operations required by the algorithm:
    \[
    O^\sim(kn(Lb+d^{2n}(s+d)(L+d))),
    \]
    where it also follows from \cite[Algorithm 2]{SH} that the polynomials in the output have degree at most $d^n,$ and height at most
    \[
    O^{\sim}((s+d)d^n).
    \]
\end{enumerate}
%
\par \noindent 
\textbf{Probability of success:} Note that when $\epsilon < 5/21$ (as stated in step 1 of Algorithm 1), then
\[
\pr[A \not \in \D] = 1-\epsilon > \frac{16}{21},
\]
so that after a single run of \cite[Algorithm 2]{SH}, the probability of success (ensuring all genericity properties and obtaining all points) is at least 
\[
\left( \frac{16}{21} \right) \left( \frac{21}{32} \right) = \frac{1}{2}.
\]
Thus, running \cite[Algorithm 2]{SH} $k$ times gives a list of outputs among which the highest cardinality set includes all points with probability at least $1-(1/2)^k$. We repeat this $n$ times to obtain $n$ zero-dimensional parameterizations. Thus, the probability that we have every point in each parameterization is $(1-(1/2)^k)^n$. We want 
\[
(1-(1/2)^k)^n>\frac{1}{2},
\]
which holds if and only if 
\[
k > -\lg(1-2^{(-1/n)}),
\]
thus proving Theorem 1.1. We can boost our success probability by running the main algorithm $\kt$ times, so that we obtain parameterizations whose reunion includes at least one point in each connected component of $V(f) \cap \R^n$ with probability at least $1 - (1/2)^{\kt}$. 
%%
%% The next two lines define the bibliography style to be used, and
%% the bibliography file.
\bibliographystyle{ACM-Reference-Format}
\bibliography{sample-base}
%%
\end{document}
\endinput
%%
%% End of file `sample-xelatex.tex'.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
