\documentclass[sigconf]{acmart}


% packages 
\usepackage[ruled,vlined]{algorithm2e}
\usepackage[titles]{tocloft}%----------------------------------------
\usepackage{mathrsfs}
\usepackage{bm}
\usepackage{enumitem}
% new commands and shortcuts
\def\td{{\bf todo}}
\def\bs{\textit{\textbf{s}}}
\def\bz{\textit{\textbf{0}}}
\def\Lb{\textit{\textbf{L}}}
\def\Xb{\textit{\textbf{X}}}
\def\Lambdab{\bm{\Lambda}}
\def\Thetab{\bm{\Theta}}
\def\thetab{\bm{\vartheta}}
\def\mA{{\bm A}}
\def\fA{{\frak A}}
\def\xb{\textit{\textbf{x}}}
\def\fb{\textit{\textbf{f}}}
\def\ab{\textit{\textbf{a}}}
\def\pb{\textit{\textbf{p}}}
\def\ajb{\overline{a_j}}
\def\bjb{\overline{b_{j,l}}}
\def\pjb{\overline{P_{j}}}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\htt}{ht}
\def\C{\mathbb{C}}
\def\pr{\mathbb{P}}
\def\vt{\vartheta}
\def\Q{\mathbb{Q}}
\def\R{\mathbb{R}}
\def\K{\mathbb{K}}
\def\rs{\mathscr{R}}
\def\P{\mathscr{P}}
\def\d{\delta}
\def\sing{ \textrm{sing}}
\def\codim{ \textrm{codim}}
\def\jac{ \textbf{jac}}
\def\exp{\textrm{exp}}
\def\grad{\textbf{grad}}
\def\rank{\textrm{rank}}
\def\reg{\textrm{reg}}
\def\jt{\widetilde{J}}
\def\At{\widetilde{A}}
\def\Yt{\widetilde{Y}}
\def\dtt{\widetilde{d}}
\def\kt{\widetilde{k}}
\def\dt{s}
\def\bI{\textbf{I}}
%% \def\dt{\widetilde{d}}
\def\Dt{\widetilde{D}}
\def\rk{\textrm{rank }}
\def\pa{\partial}
\def\D{\Delta}
\def\Z{\frak{Z}}
\newcommand{\ZZ}{{\mathbb{Z}}}
\newcommand{\softO}{{O^{\sim}}}
\def\I{\frak{I}}
\def\Is{\frak{I}^{\star}}
\def\A{\frak{A}}
\def\fp{\frak{P}}
\def\sp{\mathscr{P}}
\def\la{\langle}
\def\ra{\rangle}
% matrices 
\def\scrQ{\ensuremath{\mathscr{Q}}}
\def\bbm{\begin{bmatrix}}
\def\ebm{\end{bmatrix}}
%%
%% \BibTeX command to typeset BibTeX logo in the docs
\AtBeginDocument{%
  \providecommand\BibTeX{{%
    \normalfont B\kern-0.5em{\scshape i\kern-0.25em b}\kern-0.8em\TeX}}}

%% Rights management information.  This information is sent to you
%% when you complete the rights form.  These commands have SAMPLE
%% values in them; it is your responsibility as an author to replace
%% the commands and values with those provided to you when you
%% complete the rights form.
\setcopyright{acmcopyright}
\copyrightyear{2020}
\acmYear{2020}
\acmDOI{10.1145/1122445.1122456}

%% These commands are for a PROCEEDINGS abstract or paper.
%\acmConference[ Kalamata, Messinia, Greece '20]{ Kalamata, Messinia, Greece '20: ACM International Symposium on Symbolic and Algebraic Computation}{July 20--23, 2020}{ Kalamata, Messinia, Greece}
\acmBooktitle{ Kalamata, Messinia, Greece '20: ACM International Symposium on Symbolic and Algebraic Computation,  July 20--23, 2020,  Kalamata, Messinia, Greece}
\acmPrice{15.00}
\acmISBN{978-1-4503-XXXX-X/18/06}


\usepackage[ruled,vlined]{algorithm2e}
\usepackage{chngcntr}
\usepackage{titlesec}

\begin{document}

%%
%% The "title" command has an optional parameter,
%% allowing the author to define a "short title" to be used in page headers.
%\title{Bit Complexity for Computation of one Point in each Connected
%Component of a Smooth Real Hypersurface}
\title{On the Bit Complexity of Finding Points in Connected Components of a Smooth Real Hypersurface}

%%
%% The "author" command and its associated commands are used to define
%% the authors and their affiliations.
%% Of note is the shared affiliation of the first two authors, and the
%% "authornote" and "authornotemark" commands
%% used to denote shared contribution to the research.
\author{Jesse Elliott}
\affiliation{%
  \institution{Cheriton School of Computer Science}
  \city{University of Waterloo}
}
\email{jakellio@uwaterloo.ca}

\author{Mark Giesbrecht}
\affiliation{%
  \institution{Cheriton School of Computer Science}
  \city{University of Waterloo}
}
\email{mwg@uwaterloo.ca}

\author{\'Eric Schost}
\affiliation{%
  \institution{Cheriton School of Computer Science}
  \city{University of Waterloo}
}
\email{eschost@uwaterloo.ca}
%%
%% By default, the full list of authors will be used in the page
%% headers. Often, this list is too long, and will overlap
%% other information printed in the page headers. This command allows
%% the author to define a more concise list
%% of authors' names for this purpose.
\renewcommand{\shortauthors}{Elliott, Giesbrecht, and Schost.}

\begin{abstract}
  We present a full analysis of the bit complexity of an efficient
  algorithm for the computation of at least one point in each
  connected component of a smooth real hypersurface. This is a basic
  and important operation in semi-algebraic geometry: it gives an
  upper bound on the number of connected components of a real
  hypersurface, and is also used in many higher level algorithms.
  
  Our starting point is an algorithm by Safey El Din and Schost ({\em
    Polar varieties and computation of one point in each connected
    component of a smooth real algebraic set}, ISSAC'03). This
  algorithm uses random changes of variables, that are proved to
  generically ensure certain desirable geometric properties. The
  cost of the algorithm was given in an algebraic complexity
  model; the analysis of the bit complexity and the error probability
  were left for future work.

  Our paper answer these questions. Our main contribution is a
  quantitative analysis of several genericity statements, such as
  Thom's weak transversality theorem or Noether normalization
  properties for polar varieties.
\end{abstract}

\begin{CCSXML}
<ccs2012>
 <concept>
  <concept_id>10010520.10010553.10010562</concept_id>
  <concept_desc>Computer systems organization~Embedded systems</concept_desc>
  <concept_significance>500</concept_significance>
 </concept>
 <concept>
  <concept_id>10010520.10010575.10010755</concept_id>
  <concept_desc>Computer systems organization~Redundancy</concept_desc>
  <concept_significance>300</concept_significance>
 </concept>
 <concept>
  <concept_id>10010520.10010553.10010554</concept_id>
  <concept_desc>Computer systems organization~Robotics</concept_desc>
  <concept_significance>100</concept_significance>
 </concept>
 <concept>
  <concept_id>10003033.10003083.10003095</concept_id>
  <concept_desc>Networks~Network reliability</concept_desc>
  <concept_significance>100</concept_significance>
 </concept>
</ccs2012>
\end{CCSXML}


\setcounter{secnumdepth}{4}
\renewcommand{\theparagraph}{\thesubsection.\arabic{paragraph}}
\counterwithin{paragraph}{subsection} % makes paragraph depend on subsection
\titleformat{\paragraph}[runin]{\normalfont\normalsize\bfseries}{\theparagraph.}{1em}{}
\titlespacing*{\paragraph}{0em}{1ex}{1em}
\newcommand{\pref}[1]{{\bf\ref{#1}}}

\keywords{Real algebraic geometry, transversality, Noether
  position, bit complexity}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}


\paragraph*{Background and problem statement.}
Computing one point in each connected component of a real algebraic
set $S$ is a basic subroutine in real alebraic and semi-algebraic
geometry; it is also useful in its own right, since it allows one to
decide if $S$ is empty or not. 

In this paper, we consider the case where $S$ is given as $S=V \cap
\R^n$, where $V=V(f) \subset \C^n$ is a complex hypersurface defined
by a squarefree polynomial $f \in \ZZ[X_1,\dots,X_n]$.
Algorithms for this task have been known for decades, and their
complexity is to some extent well understood. Suppose that $f$ has
degree $d$, and coefficients of bit-size $h$. Without making any
assumption on $f$, the algorithm given
in~\cite[Section~13.1]{BaPoRo03} solves our problem using $d^{O(n)}$
operations in $\Q$; in addition, the output of the algorithm is
represented by polynomials of degree $d^{O(n)}$, with coefficients of
bit-size $hd^{O(n)}$.  The key idea behind this algorithm goes back
to~\cite{GrVo88}: sample points are found through the computation of
critical points of well-chosen functions on $V(f)$.

The number of connected components of $V(f)$ admits the lower bound
$d^{\Omega(n)}$, so up to polynomial factors this result is
optimal. However, due to the generality of the algorithm, the constant
hidden in the exponent $O(n)$ in its runtime turns out to be rather
large: the algorithm relies on infinitesimal deformations, that affect
runtime non-trivially.

In this paper, we will work under the additional assumption that
$V=V(f)$ is a {\em smooth} complex hypersurface. We place ourselves in
the continuation of the line of work initiated by~\cite{BaGiHeMb97}:
that reference deals with cases where $V$ is smooth and $V \cap \R^n$
is compact, pointing out how {\em polar varieties} (that were
introduced in the 1930's in order to define characteristic
classes~\cite{Piene78,Teissier88}) can play a role in effective real
geometry. This paper was extended in several directions: to $V$ being
a smooth complete intersection, still with $V\cap \R^n$
compact~\cite{BaGiHeMb01}, then without the compactness
assumption~\cite{EMP,BaGiHePa05}; the smoothness assumption was then partly
dropped in~\cite{BaGiHe14,BaGiHeLePa12}.

Our starting point is the algorithm in~\cite{EMP}. In the hypersurface
case, its runtime is $d^{(4+o(1))n}$ operations in $\Q$.  As with many
results in this vein, the algorithm is randomized: we need to assume
that we are in generic coordinates; this is done by applying a random
change of coordinates prior to all computations. In addition, the
algorithm relies on procedures for solving systems of polynomial
equations that are themselves randomized.  Altogether, we choose
$n^{O(1)}$ random vectors, each of them in an affine space of
dimension $n^{O(1)}$; every time a choice is made, there exists a
hypersurface of the parameter space that one has to avoid in order to
guarantee success. In this paper, we revisit this algorithm and give a
complete analysis of its probality of success and its bit complexity.

\paragraph*{Data structures.} As in references such
as~\cite{GiHeMoPa95,GiHaHeMoMoPa97,GiHeMoMoPa98,BaGiHeMb97,EMP}, the
input polynomial $f$ is given by means of a {\em straight-line
  program}, that is, a sequence of operations $+,-,\times$ that takes
as input $X_1,\dots,X_n$ and evaluates $f$; the {\em length} of a
straight-line program is simply the number of operations it performs.

Any polynomial of degree $d$ in $n$ variables can be computed by a
straight-line program of length $O\big ({{d+n} \choose n}\big)$:
evaluate all monomials of degree up to $d$ in $n$ variables, multiply
them by their respective coefficients and sum the result. However,
some inputs may be given by shorter straight-line program, and the
algorithm is able to benefit from this.

The output of the algorithm is a finite set in $\overline{\Q}{}^n$. To
represent it, we rely on a widely used data structure based on
univariate
polynomials~\cite{Kronecker82,Macaulay16,GiMo89,GiHeMoPa95,ABRW,GiHaHeMoMoPa97,GiHeMoMoPa98,Rouillier99}.
Consider a zero-dimensional algebraic set $S \subset \C^n$ defined
over $\Q$. A {\em zero-dimensional parametrization}
$\scrQ=((q,v_1,\dots,v_n),\lambda)$ of $S$ consists in polynomials
$(q,v_1,\dots,v_n)$, such that $q\in \Q[T]$ is monic and squarefree,
all $v_i$'s are in $\Q[T]$ and satisfy $\deg(v_i) < \deg(q)$, and in a
$\Q$-linear form $\lambda$ in variables $X_1,\dots,X_n$, such that
\begin{itemize}
\item $\lambda(v_1,\dots,v_n)=T q' \bmod q$;
\item we have the equality
  $S=\left \{\left(
      \frac{v_1(\tau)}{q'(\tau)},\dots,\frac{v_n(\tau)}{q'(\tau)}\right
    ) \ \mid \ q(\tau)=0 \right \}.$
\end{itemize}
The constraint on $\lambda$ says that the roots of $q$ are the values
taken by $\lambda$ on $S$. The parametrization of the coordinates by
rational functions having $q'$ as a denominator goes back
to~\cite{Kronecker82,Macaulay16}: as pointed out in~\cite{ABRW}, it
allows one to control precisely the size of the coefficients of
$v_1,\dots,v_n$.

\paragraph*{Main result.} To state our main result, we need to define 
the {\em height} of a rational number, and of a polynomial with
rational coefficients.

The {\em height} of a non-zero $a=u/v \in \Q$ is the maximum of
$\ln(|u|)$ and $\ln(v),$ where $u \in \mathbb{Z}$ and $v \in
\mathbb{N}$ are coprime. For a polynomial $f$ with rational
coefficients, if $v \in \mathbb N$ is the minimal common denominator
of all non-zero coefficients of $f$, then the \textit{height}
$\htt(f)$ of $f$ is defined as the maximum of the logarithms of $v$
and of the absolute values of the coefficients of $vf$.

\begin{theorem}\label{theo:main}
  Suppose that $f\in\ZZ[X_1\hdots,X_n]$ is squarefree, satisfies
  $\deg(f) \leq d, \htt(f) \leq s$, and that $V(f) \subset \C^n$ is
  smooth.  Assume also that $f$ is given by a straight-line program
  $\Gamma$ of size $L$ with integer constants of height at most $b.$

  There exists a randomized algorithm that takes $\Gamma, d,$ and $s$
  as input and produces a zero-dimensional parameterization of a set
  that contains at least one point in each connected component of
  $V(f) \cap \R^n$. 
  
  As part of the randomization, the algorithm chooses a set 
  \[
  S := \{1,2,\hdots,2\epsilon^{-1}3n^2(2d)^{2n}\}
  \]
  from which to sample. 
  
  With probability at least $1-\epsilon$, the output is correct. Otherwise, either a proper subset of the points is produced, or FAIL.  In any case, the algorithm uses
  \[
  O^{\sim}(nk(Lb+d^{2n}(s + \log 1/\epsilon+d)(L+d)\log(s + \log 1/\epsilon)))
  \]
  bit operations, with $k \geq 1 + \lg n + \lg(1/\epsilon)$. The polynomials in
  the output have degree at most $d^n,$ and height 
  \[
  O^{\sim}((s+\lg 1/\epsilon + d)d^n)
  =O^{\sim}((s+\lg 1/\epsilon)d^{n+1}).
  \]
\end{theorem}

The runtime for cases without a straight-line program in the input are as follows. In these cases a polynomial $f$ of degree $d$ is given in the input, and a straight-line program is built for it by computing all the terms. In this case, $L \geq d^n$ and $b \geq \htt(f) = s,$ so that the number of bit operations becomes
\begin{align*}
&O^{\sim}(nk(d^ns+d^{2n}(s + \log 1/\epsilon+d)(d^n+d)\log(s + \log 1/\epsilon)))\\
      &= 
O^{\sim}(nk(d^ns+(d^{3n}+d^{2n+1})(s + \log 1/\epsilon+d)\log(s + \log 1/\epsilon)))\\
     &= 
O^{\sim}(nk(d^{3n}(s + \log 1/\epsilon+d)\log(s + \log 1/\epsilon)))\\
     &= 
O^{\sim}(nk(d^{3n+1}(s + \log 1/\epsilon)\log(s + \log 1/\epsilon))),
\end{align*}
and the degree and height of the output does not change.

The algorithm itself is rather simple. To describe it, we need to
define {\em polar varieties}, which will play a crucial role in this
paper. Let $V=V(f)$, for $f$ as in the theorem. For $i \in
\{1,\hdots,n-1\},$ denote by $\pi_i:\C^n \rightarrow \C^i$ the
projection $(x_1,\hdots,x_n) \mapsto (x_1,\hdots,x_i)$.  The $i$-th
\textit{polar variety} \[W(\pi_i,V) := \{\xb \in V~|~\dim \pi_i(T_\xb
V) < i\}\] is the set of critical points of $\pi_i$ on $V$.  It is
thus defined by the vanishing of \[f,\frac{\pa f}{\pa
  X_{i+1}},\hdots,\frac{\pa f}{\pa X_n}.\]

In general, we cannot say much about the geometry of
$W(\pi_i,V)$, but if we apply a generic change of coordinates $\mA$,
$W(\pi_i,V)$ is then known to be equidimensional of dimension $(i-1)$
or empty~\cite{BaGiHeMb97}, and to be in so-called {\em Noether
  position}~\cite{EMP} (background notions in algebraic geometry are
in~\cite{Mumford76,Shafarevich77,ECA}; we will recall key
definitions). If this is case, it suffices to choose arbitrary
$\alpha_1,\dots,\alpha_{n-1}$ in $\Q$, and solve the systems defined
by
\begin{equation}\label{eq:syst}
X_1-\alpha_1,\dots,X_{i-1}-\alpha_{i-1}, f, \frac{\pa f}{\pa
  X_{i+1}} ,\dots,\frac{\pa f}{\pa X_n},  
\end{equation}
for $i=1,\dots,n$.  They all admit finitely many solutions, and
Theorem~2 in~\cite{EMP} proves that the union of their solution sets
contains one point on each connected component of $V \cap \R^n$.

Our main contribution is to analyse precisely what conditions on our
change of coordinates $\mA$ guarantee success. This is done by
revisiting the key ingredients in the proofs given
in~\cite{BaGiHeMb97} and~\cite{EMP}, and giving quantitative versions
of these results, bounding the degree of the hypersurfaces we have to
avoid.  To solve the equations~\eqref{eq:syst}, we use the algorithm
in~\cite{SH}, for which a complete bit complexity analysis is
available.

This work should be seen as a first step toward the analysis of
further randomized algorithms in real algebraic geometry. An immediate
follow-up question would be to handle the case of algebraic sets
defined by {\em regular sequences}: the algorithm in~\cite{EMP} still
applies, but the modifications needed are beyond the scope of this
publication. Further still, randomized algorithms for deciding {\em
  connectivity queries} on smooth, compact algebraic sets have been
developed in a series of papers
\cite{SchostMohabBabySteps2011,SchostMohabBabySteps2014}, and could be
revisited using the techniques introduced here.

%% The \textit{dimension} of an algebraic set $V \subset \C^n$, denoted $\dim V,$ can be defined in the following ways:
%% %
%% \begin{enumerate}
%%     \item The number of generic hyperplanes needed to intersect with $V$ to obtain a finite set. 
%%     \item The Krull Dimension of $\C[X_1,\hdots,X_n]/I(V)$.
%% \end{enumerate}
%% %
%% The \textit{codimension} of $V$ is $n - \dim V$. An algebraic set is \textit{equidimensional} if each irreducible component has the same dimension.  If each component has dimension $d$ then we say it is $d-$equidimensional. 
%% The \textit{degree} of an algebraic set is the number of intersection points between itself and $\dim V$ generic hyperplanes.
%% %
%% \begin{example} 
%% An algebraic set of dimension zero is a finite set, with degree equal to its cardinality.
%% \end{example}
%% %
%% \begin{example}
%% An algebraic set of dimension 1 is a curve, with degree equal to the number of intersection points with a generic hyperplane.
%% \end{example}
%% %
%% %
%% %


%% Let $V \subset \C^n$ be a $d$-equidimensional algebraic set.  The
%% point $x \in V$ is a \textit{regular point} if $\dim (T_xV) = d.$
%% Otherwise $x$ is a \textit{singular point}. We let $\reg(V)$ and
%% $\sing(V)$ respectively denote the regular and singular points of $V$.

%% %
%% \subsubsection{Critical points of polynomial mappings}
%% %
%% Let $\phi : V \rightarrow \C^m$ be a polynomial mapping. A \textit{critical point} of $\phi$ is a regular point of $V$ with $d_x \phi(T_xV) \not = \C^m,$ where $d_x \phi$ is the differential of $\phi$ at $x.$ A \textit{critical} value of $\phi$ is the image of a critical point by $\phi$.
%% %
%% \subsection{The zariski-tangent space}
%% %
%% Denote by $\grad_{\xb}(f)$ the evaluation of the gradient vector of $f$ in $\C[X_1,\hdots,X_n]$ at $\xb$ in $\C$.
%% The \textit{Zariski-tangent space} to $V$ at $\xb \in V$ is the vector space $T_{\xb}V$ defined by the equations $\grad_{\xb}(f) \cdot \textit{\textbf{v}}=0$ for all polynomials $f$ that vanish on $V$. For a polynomial system $\textit{\textbf{f}}=(f_1,\hdots,f_N)$ in $\C[X_1,\hdots,X_n]$, denote by $\jac(\textit{\textbf{f}})$ the Jacobian matrix.
%% The following is a direct consequence of \cite[Corollary 16.20]{ECA}.
%% %
%% \begin{proposition}
%% If $V \subset \C^n$ is a $d$-equidimensional algebraic set with ideal $I(V)=\langle f_1,\hdots,f_N \rangle$, then at any point $\textbf{x}$ of $\reg(V),$ $\jac_\textbf{x}(\textbf{f})$ has full rank $n - \dim(V)$ and the kernel of $\jac_\textbf{x}(\textbf{f})$ is equal to $T_\textbf{x}V.$ 
%% \end{proposition}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Genericity properties}\label{sec:gen}

Consider $f \in \ZZ[X_1,\hdots,X_n]$ with total degree $d$, and assume
that $f$ is squarefree and that $V(f) \subset \C^n$ is smooth. The key
to the proof of Theorem~\ref{theo:main} is the following quantitative
version of facts we stated above, namely that in generic coordinates,
polar varieties are smooth, equidimensional, and in Noether position
(or empty).

We recall that an equidimensional algebraic set $X \subset \C^n$ of
dimension $d$ is in \textit{Noether position} for the projection
$\pi_d$ when the extension $\C[X_1,\hdots,X_d] \rightarrow
\C[X_1,\hdots,X_n]/I(X)$ is integral; here, $I(X) \subset
\C[X_1,\dots,X_n]$ is the defining ideal of $X$. In this case, for any
$\xb \in \C^d,$ the fiber $X \cap \pi_d^{-1}(\xb)$ has dimension zero
(so it is finite and not empty).

For $i$ in $\{1,\dots,n\}$ and $f$ as above, we will let $\I(i, f)$
denote the sequence of $n-(i-1)$ polynomials $(f, {\pa f}/{\pa
  X_{i+1}},\dots,{\pa f}/{\pa X_n})$. As pointed out in the
introduction, their zero-set is the $i$th polar variety
$W(\pi_i,V(f))$.  Then, we say that $f$ satisfies $\textbf{H}_i$ if
\begin{enumerate}
\item For any $\xb$ in $W(\pi_i,V(f))$, the Jacobian matrix
  $\jac_\Xb(\I(i, f))$ has full rank $n-(i-1)$ at $\xb$.

  {\em By the Jacobian Criterion~\cite[Corollary 16.20]{ECA}, this
  implies that $W(\pi_i,V(f))$ is either empty or $(i-1)$-equidimensional,
  and that $\I(i, f^\mA)$ is radical.}

\smallskip

\item $W(\pi_i,V(f))$ is either empty or in Noether position for
  $\pi_{i-1}$.
\end{enumerate}
When this holds, given $\bm \sigma = (\sigma_1,\hdots,\sigma_{i-1})$
in $\C^{i-1}$, we further say that $f$ and $\bm \sigma$ satisfy
$\textbf{H}'_i$ if
\begin{enumerate}
\item The ideal  $(X_1-\sigma_1,\dots,X_{i-1}-\sigma_{i-1},f, {\pa f}/{\pa
  X_{i+1}},\dots,{\pa f}/{\pa X_n})$ is
  radical.

  {\em By point (2) above, we know that there are finitely many solutions 
    to these equations.}
\end{enumerate}

Even if $f$ does not initially satisfy $\textbf{H}_i$, it does after applying a generic change of variables. The precise
statement is as follows, for which we use the following
notation. For a matrix $\mA$ in $\C^{n\times n}$ and $g$ in
$\C[X_1,\hdots,X_n]$ we write $g^\mA:=g(\mA \Xb) \in
\C[X_1,\dots,X_n]$, where $\Xb$ is the column vector with entries
$X_1,\dots,X_n$.

We will also have to consider matrices with generic entries. For this,
we introduce $n^2$ new indeterminates $(\frak A_{j,k})_{1\le j,k \le
  n}$. Then, $\A$ will denote the matrix with entries $(\frak
A_{j,k})_{1\le j,k \le n}$, $\C(\A)$ will denote the rational function
field $\C((\frak A_{j,k})_{1\le j,k \le n})$ and $\C[\A]$ the
polynomial ring $\C[(\frak A_{j,k})_{1\le j,k \le n}]$.  For $f$ as
above, we will then define the polynomial $f^\A:=f(\A \Xb)$, 
which we may consider in either
$\C(\A)[X_1,\dots,X_n]$ or $\C[\A,X_1,\dots,X_n]$.

\smallskip

This being said, our two key results are the following.
\begin{theorem}\label{theo:gen}
  For $i=1,\dots,n$, there exists a non-zero polynomial $\D_i$ in
  $\C[\A]$ of degree at most $6n^2(2d)^{2n}$ such that if $\mA \in
  \C^{n\times n}$ does not cancel $\D_i$, then $\mA$ is invertible and
  $f^\mA$ satisfies $\textbf{H}_i$.
\end{theorem}

\begin{theorem}\label{theo:Hp}
  Suppose that $f$ satisfies $\textbf{H}_i$. There exists a non-zero
  polynomial $\Xi_{i} \in \C[S_1,\dots,S_{i-1}]$ of degree at most
  $d^{2n}$ such that if $\bm \sigma \in \C^{i-1}$ does not
  cancel $\Xi_{i}$, then $f$ and $\bm \sigma$ satisfy $\textbf{H}_i'$.
\end{theorem}
\noindent 
The proof of these theorems occupies the next two sections.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Weak Transversality and Applications}

Sard's lemma states that the set of critical values of a smooth
function $\R^n \to \R^m$ has measure zero. One can give ``algebraic''
versions of it, for semi-algebraic mappings $\R^n \to \R^m$ as
in~\cite[Chapter~9]{bochnak1998real}, or polynomial mappings $\C^n \to
\C^m$ as in~\cite[Chapter~3]{Mumford76}, for which the sets of
critical values are contained in strict semi-algebraic,
resp.\ algebraic sets in the codomain. Thom's weak transversality
lemma, as given for instance in~\cite{demazure2000bifurcations},
generalizes Sard's lemma. In this section, we consider a particular
case of this result (transversality to a point), and establish a
quantitative version of it; this will allow us to establish the first
item in property ${\bf H}_i$, as well as property ${\bf H}'_i$. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Weak Transversality}

Transversality to a point can be rephrased entirely in terms of
critical and regular values. Recall that if $\bm \Psi$ is a mapping
from a smooth algebraic set $Y$ to $\C^t$, with $t\le \dim(Y)$, a {\em
  critical point} of $\bm \Psi$ is a point $\bm y \in Y$ such that the
image of the tangent space $T_{\bm y} Y$ by the differential $d_{\bm
  Y} \bm \Psi$ has dimension less than $t$. When for instance
$Y=\C^v$, we have $T_{\bm y} Y=\C^v$ and this condition is equivalent
to the Jacobian of $\bm \Psi$ having rank less than $t$ at $\bm y$.
{\em Critical values} are the images by $\Psi$ of critical points; the
complement of this set are the {\em regular values} (so a regular
value is not necessarily in the image of~$\bm\Psi$).

Let then $n,\dt,$ and $m$ be positive integers, with $m \le n$, and denote
by $\bm\Phi :\C^n \times \C^{\dt} ~ \rightarrow \C^{m}$ a mapping
defined by polynomials in $\C[\Xb,\Thetab]$, where $\Xb$,
resp.\ $\Thetab$, is a set of $n$, resp.\ $\dt$, indeterminates.  For
$\thetab$ in $\C^{\dt}$, let $\bm\Phi_{\thetab} : \C^n \rightarrow
\C^{m}$ be the induced mapping $\xb\mapsto \bm\Phi(\xb,\thetab)$.  The
transversality result we will need is the following.

\begin{proposition} [Weak transversality]\label{prop:weak_t}
  Suppose that $\bm 0$ is a regular value of $\bm\Phi$. Then there
  exists a non-zero polynomial $\Gamma \in \C[\Thetab]$ of degree at
  most $d^{m+n}$ such that for $\thetab$ in $\C^\dt$, if
  $\Gamma(\thetab)\ne 0$, then $\bm 0$ is a regular value
  of~$\bm\Phi_{\thetab}$.
\end{proposition}

The following simple example shows this result at work. Consider a
squarefree $f$ in $\C[X_1,X_2]$, such that $V(f)$ is a smooth curve in
$\C^2$, and let the mapping $\bm\Phi:\C^2\times \C \to \C^2$ be
defined by $\bm\Phi(X_1,X_2,\Theta) = (f(X_1,X_2), X_1-\Theta)$. One
checks that the Jacobian of $\bm\Phi$ with respect to
$(X_1,X_2,\Theta)$ has rank two at any point in $\bm\Phi^{-1}(\bm 0)$,
so the assumptions of the proposition apply. We deduce that for a
generic $\vartheta$ in $\C$, that is, for all $\vartheta$ in $\C$
except a finite number, the ideal $(f(X_1,X_2), X_1-\vartheta)$ is
radical in $\C[X_1,X_2]$; equivalently, $f(\vartheta, X_2)$ is
squarefree. We will revisit this example in Section~\ref{ssec:fiber}.

The rest of the subsection is devoted to the proof of the proposition.
The proof of \cite[Theorem B.3]{TWT} already shows the existence of
$\Gamma$; it is essentially the classical proof for smooth
mappings~\cite[Section~3.7]{demazure2000bifurcations}, written in an
algebraic context. In what follows, we revisit this proof,
establishing a bound on the degree of $\Gamma$.

Put $V = \bm\Phi^{-1}(\bm 0)$. If $V$ is empty, there is nothing to do,
since all values $\thetab$ in $\C^\dt$ satisfy the conclusion of the
proposition. Thus, we assume that $V$ is not empty. Then, the Jacobian
criterion shows that $V$ is smooth and $(n+ \dt -m)$-equidimensional.

We will reuse the following fact, proved in~\cite{TWT}.  Consider the
projection $\pi:(\xb, \thetab) \in \C^n \times \C^{\dt} \mapsto
\thetab \in\C^{\dt}$.  Let $Z$ be the set of critical points of
$\pi_{|V}$, and consider its projection $\pi(Z)$ in $\C^s$. This is
the set of critical values of $\pi_{|V}$; hence, by the algebraic form
of Sard's lemma (see \cite[Theorem~3.7]{Mumford76} for irreducible $V$
and~\cite[Proposition~B.2]{TWT} for general $V$), its Zariski closure
$\overline{\pi(Z)}$ is a strict closed subset of $\C^s$. As we will
see below, if $\thetab \in \C^{\dt}$ is not in $\overline{\pi(Z)}$,
then $\bm 0$ is a regular value of $\bm\Phi_{\thetab}$.

To describe the set $Z$ of critical points of $\pi_{|V}$, let $\bm M$
denote the $(s+m) \times (s+n)$ Jacobian matrix with entries in
$\C[\Xb,\Thetab]$ given by $\bm M = \jac_{\Xb,\Thetab}(\pi,\bm\Phi)$,
that is,
\begin{align*}
\bm M &= 
\bbm 
\jac_{\Xb,\Thetab}(\pi)\\
\jac_{\Xb,\Thetab}(\bm\Phi) 
\ebm 
=
\bbm 
\textbf{0}_{\dt \times n}\hspace{5mm}\textbf{I}_{\dt} \\
\jac_{\Xb,\Thetab}(\bm\Phi)
\ebm.
\end{align*}

\begin{lemma} 
  For $(\xb,\thetab)$ in $V$, $(\xb,\thetab)$ is in $Z$ if and only if
  the matrix $\bm M$ has rank less than $\dt+m$ at $(\xb,\thetab)$.
\end{lemma}
\begin{proof}
  Take $(\xb,\thetab)$ on $V$, and let $\bm K(\xb,\thetab)$ be the
  Jacobian matrix $\jac_{\Xb,\Thetab}(\bm\Phi)$ taken at $(\xb,\thetab)$.
  Then, the rank of $\bm M(\xb,\thetab)$ can be written as
  $\textup{rank}(\bm K(\xb,\thetab)) + \textup{rank}([\textbf{0}_{\dt
      \times n}~\textbf{I}_{\dt}] \mid \ker \bm K(\xb,\thetab))$, where
  the latter is the rank of the restriction of $[\textbf{0}_{\dt
      \times n}~\textbf{I}_{\dt}]$ to the nullspace of
  $\bm K(\xb,\thetab)$.

  Since $V$ is smooth, $\bm K(\xb,\thetab)$ has full rank ${\rm codim}
  (V) = m$. On the other hand, the nullspace of $\bm K(\xb,\thetab)$
  is the tangent space $T_{\xb,\thetab} V$, and
  $\textup{rank}([\textbf{0}_{\dt \times n}~\textbf{I}_{\dt}] \mid
  \ker \bm K(\xb,\thetab))$ is the dimension of $\pi(T_{\xb,\thetab}
  V)$.  In other words, the rank of $\bm M(\xb,\thetab)$ is equal to
  $m+\dim(\pi(T_{\xb,\thetab} V))$; this implies the claim in the
  lemma.
\end{proof}

Therefore, we can characterize the set $Z$ of critical points of
$\pi_{|V}$ as those points satisfying $\bm\Phi(\xb,\thetab)=\bm 0$ and
where all minors of $\bm M$ of order $\dt+m$ vanish. We can actually
describe this set using a smaller matrix, by discarding certain minors
that are identically zero. Let indeed $\bm J$ denote the $m \times n$
submatrix of the Jacobian of $\bm\Phi$ consisting of the first $n$
columns. This is the Jacobian matrix of $\bm \Phi$ with respect to $\Xb$.
\begin{lemma} 
  For $(\xb,\thetab)$ in $V$, $(\xb,\thetab)$ is in $Z$ if and only if
  $\bm J(\xb,\thetab)$ has rank less than $m$.
\end{lemma}
\begin{proof}
Notice 
%
\begin{align*}
M(\xb,\thetab)&= 
\bbm 
\textbf{0}_{\dt \times n} &\textbf{I}_{\dt} \\
\bm J(\xb,\thetab)     &\bm J'(\xb,\thetab)
\ebm,
\end{align*}
where $\bm J'$ consists of the remaining columns of the Jacobian matrix of
$\bm\Phi$.  Then, the rank of the former matrix is equal to the rank
of
\begin{align*}
M(\xb,\thetab)&= 
\bbm 
\textbf{0}_{\dt \times n} &\textbf{I}_{\dt} \\
\bm J(\xb,\thetab)     & \bm 0_{m \times s}
\ebm,
\end{align*}
and the conclusion follows.
\end{proof}

In particular, take $\thetab$ in $\C^\dt - \overline{\pi(Z)}$.
Then for all $\xb$ in $\bm \Phi_{\thetab}^{-1}(\bm 0)$, $(\xb,\thetab)$
is in $V$, so it is not in $Z$. The previous lemma then implies that
the Jacobian matrix $\bm J$ of $\bm\Phi_{\thetab}$ has full rank $m$ at
$(\xb,\thetab)$. In other words, $\bm 0$ is a regular value of $\bm
\Phi_{\thetab}$, as claimed.

Our next step is to bound the degree of $Z$.  In that, we use the
definition of degree given in~\cite{H}: the degree of an irreducible
algebraic set is the number of intersection points it has with a
generic hyperplane of complementary dimension, and the degree of an
arbitrary algebraic set is the sum of the degrees of its irreducible
components.  To obtain an estimate on the degree of $Z$, rather than
considering minors of $\bm J$, we will rewrite the condition that $\bm
J(\xb,\thetab)$ has rank less than $m$ as the existence of a
non-trivial left kernel element.

For this, we let $\textit{\textbf{L}}=[L_1,\hdots,L_m]$ be new
variables, thought of as Lagrange multipliers, and consider the
``Lagrange polynomials'' $\mathscr{L}_1,\dots,\mathscr{L}_{n}$, with
\[
[\mathscr{L}_1 \cdots \mathscr{L}_{n}]=\textit{\textbf{L}}\cdot \bm J(\xb,\thetab).
\] 
Denote by $\frak{Z} \subset \C^{n+\dt+m}$ the algebraic set defined by
the vanishing of $\mathscr{L}_1,\hdots,\mathscr{L}_{n},$ and
$\bm\Phi$, and by $\frak{Z}'$ the algebraic set
\[
\frak{Z}' := \overline{\frak{Z} - \{(\xb,\thetab,0,\hdots,0) \in \C^{n+\dt+m}~|~(\xb,\thetab,0\hdots,0) \in \frak{Z}\}},
\]
where the bar denotes Zariski closure (we have to remove such points,
since $L_1=\cdots=L_m=0$ is always a trivial solution to the Lagrange
equations). Finally, consider the projection
\begin{align*} 
\mu :~ \C^{n+\dt+m} &\rightarrow \C^{n+\dt}\\
(\xb,\thetab,\bm \ell)~ &\mapsto (\xb,\thetab).
\end{align*}

\begin{lemma}  
  The algebraic set $Z$ is equal to the projection $\mu(\frak{Z}')$.
\end{lemma}
\begin{proof}
  Take $(\xb,\thetab)$ in $Z$. Then, $(\xb,\thetab)$ cancels all
  polynomials $\bm \Phi$, and there exists $\bm
  \ell=(\ell_1,\dots,\ell_m)$, not identically zero, such that
  $(\xb,\thetab,\bm \ell)$ cancels the Lagrange polynomials. This
  implies that $(\xb,\thetab,\bm \ell)$ is in $\frak{Z} -
  \{(\xb',\thetab',0,\hdots,0) \in
  \C^{n+\dt+m}~|~(\xb',\thetab',0\hdots,0) \in
  \frak{Z}\}$, and thus in $\frak{Z}'$. This proves the inclusion
  $Z \subset \mu(\frak{Z}')$.

  Conversely, take an irreducible component $Y$ of $\frak Z'$. We
  prove that $\mu(Y)$ is contained in $Z$.  By construction, there
  exists an open dense subset $Y^o \subset Y$ such that for any
  $(\xb,\thetab,\bm \ell)$ in $Y^o$, $\bm \ell$ is not identically
  zero. As a result, $(\xb,\thetab)$ is in $Z$, that is, $\mu(Y^o)$ is
  in $Z$. This implies that its Zariski closure $\overline{\mu(Y^o)}$
  is in $Z$. Since $\mu(Y)$ is contained in $\overline{\mu(Y^o)}$, we
  deduce $\mu(Y) \subset Z$. Taking the union over all $Y$, we get
  $\mu(\frak Z') \subset Z$, as claimed.
\end{proof}
%
\begin{corollary} 
  The degree of $Z$ is at most $d^{m+n}.$
\end{corollary}
\begin{proof}
  The algebraic set $\frak Z$ is defined by $m+n$ equations, all of
  them having degree at most $d$. It follows from B\'ezout's
  Theorem~\cite{H} that $\deg(\frak{Z}) \leq d^{m+n}$, and the same
  upper bound holds for $\deg(\frak{Z}')$, since it consists of
  certain irreducible components of $\frak Z$. Applying the projection
  $\mu$ yields the result, since degree cannot increase through
  projection.
\end{proof}

In particular, we obtain the same degree bound for
$\overline{\pi(Z)}$.  It then suffices to take for $\Gamma$ any
non-zero polynomial of degree at most $d^{m+n}$ that vanishes on
$\overline{\pi(Z)}$; this proves Proposition~\ref{prop:weak_t}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Application: property $\textbf{H}_i(1)$}\label{ssec:Hi1}

Let $f \in \ZZ[X_1,\hdots,X_n]$ have total degree $d$, with $V(f)
\subset \C^n$ smooth. In what follows, we fix $i$ in $1,\dots,n$, and
we prove the following: {\em there exists a non-zero polynomial
  $\D_{i,1} \in \C[\A]$ of degree at most $2nd^{2n}$ such that if $\mA
  \in \C^{n\times n}$ does not cancel $\D_{i,1}$, then $\mA$ is
  invertible and $f^\mA$ satisfies $\textbf{H}_i(1)$.}

The following construction is already in~\cite{BaGiHeMb97}; our
contribution is the degree estimate. We let $\bm\Phi: \C^n \times
\C^{n\times n} \to \C^{n-i+1}$ be the mapping defined by the
polynomials 
\[
  \big( f,\,\grad(f)\cdot \A_{i+1},\,\hdots,\, \grad(f)\cdot \A_n \big ),
\] 
where $\A_1,\hdots,\A_n$ denote the columns of $\A$ and $\cdot$ is the dot-product.
\begin{lemma} 
  $\bz$ is a regular value of $\bm\Phi$.
\end{lemma}
\begin{proof}
Let $(\xb,\mA) \in \C^n \times \C^{n\times n}$ be a zero of $\bm\Phi$.
We have to show that the Jacobian matrix of the equations defining
$\bm \Phi$, taken with respect to $\Xb$ and $\A$, has full rank
$n-i+1$ at $(\xb,\mA)$.
If we set 
\[
F_j = \frac{\pa f}{\pa X_1} A_{i+j,1} + \hdots + \frac{\pa f}{\pa X_n}A_{i+j,n}, ~1 \leq j \leq n-i,
\]
this Jacobian matrix is equal to
{\small \[
\left[ 
\begin{array}{cccccc}
\frac{\pa f}{\pa X_1} \hdots \frac{\pa f}{\pa X_n}             &\hdots& 0 \hdots 0                                         & \hdots & 0\hdots 0 \\ 
\frac{\pa F_{1}}{\pa X_1}\hdots \frac{\pa F_{1}}{\pa X_n}      &\hdots& \frac{\pa f}{\pa X_1} \hdots \frac{\pa f}{\pa X_n} & \hdots & 0\hdots 0 \\
\ddots                                                         &\ddots&\ddots                                              & \ddots & \ddots \\
\frac{\pa F_{n-i}}{\pa X_1}\hdots \frac{\pa F_{n-i}}{\pa X_n}  &\hdots&0 \hdots 0&  \hdots & \frac{\pa f}{\pa X_1} \hdots \frac{\pa f}{\pa X_n}  
\end{array}
\right],
\]}%
where the first columns are indexed by $X_1,\dots,X_n$ and the further
ones by $\A_{1,i+1},\dots,\A_{n,i+1},\dots,\A_{1,n},\dots,\A_{n,n}$.
Since $f(\xb)=0$, our assumption on $f$ implies that at least one of
its partial derivatives is non-zero at $\xb$, and the conclusion
follows.
\end{proof}
Since all equations defining $\bm \Phi$ have degree at most $d,$ it
follows by Proposition~\ref{prop:weak_t} that there exists a non-zero
polynomial $\Gamma_i \in \C[\A]$ of degree at most $d^{2n-i+1}\leq
d^{2n},$ with the property that, if $\mA \in \C^{n\times n}$ does not
cancel $\Gamma_i$, then the Jacobian matrix of $$\bm\Phi_\mA=\big(
f,\,\grad(f)\cdot \mA_{i+1},\,\hdots,\, \grad(f)\cdot \mA_n \big ),$$
taken with respect to $\Xb$, has full rank $n-i+1$ at all $\xb$ that
cancels equations. We then define $\Delta_{i,i}:=\Gamma_i
\det(\A)$; this is a non-zero polynomial of degree at most $d^{2n}+n
\le 2nd^{2n}$.

Let us verify that $\Delta_{i,1}$ satisfies the claim in the preamble.
Take $\mA$ in $\C^{n\times n}$, such that $\Delta_{i,i}(\mA)$ is
non-zero. Clearly, $\mA$ is invertible; it remains to check that
$f^\mA$ satisfies $\textbf{H}_i(1)$. Thus, we take $\xb$ that cancels
$(f^\mA, {\pa f^\mA}/{\pa X_{i+1}},\dots,{\pa f^\mA}/{\pa X_n})$, and
we prove that the Jacobian matrix of these equations, taken with
respect to $\Xb$, has full rank $n-i+1$ at $\xb$. Using the chain
rule, the equations above can be rewritten as $\bm\Phi_\mA(\mA \xb)$,
so their Jacobian matrix at $\xb$ has the same rank as that of
$\bm\Phi_\mA$ at $\mA \xb$, that is, $n-i+1$. Our claim is proved.

In Section~\ref{sec:Hi2}, we will need the following by-product of
this result: if we consider $f^\A \in \C(\frak
A_{j,k})[X_1,\dots,X_n]$ as defined Section~\ref{sec:gen}, this
polynomial satisfies the rank property $\textbf{H}_i(1)$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Application: property $\textbf{H}'_i$}\label{ssec:fiber}

Let $f \in \ZZ[X_1,\hdots,X_n]$ and $i$ be as before. We now assume
that $f$ satisfies $\textbf{H}_i(1)$, and we prove the following: {\em
  there exists a non-zero polynomial $\Xi_{i} \in
  \C[S_1,\dots,S_{i-1}]$ of degree at most $d^{2n}$ such that if $\bm
  \sigma =(\sigma_1,\dots,\sigma_{i-1})\in \C^{i-1}$ does not cancel
  $\Xi_{i}$, the ideal
  $$(X_1-\sigma_1,\dots,X_{i-1}-\sigma_{i-1},f, {\pa f}/{\pa
    X_{i+1}},\dots,{\pa f}/{\pa X_n})$$ is radical.}

\smallskip

Let $\bm\Psi: \C^n \times \C^{i-1} \rightarrow \C^{n}$ be the mapping defined by the polynomials
\[
  (X_1-S_1,\hdots,X_{i-1}-S_{i-1}, f,\frac{\pa f}{\pa X_{i+1}},\hdots,\frac{\pa f}{\pa X_n} ).
\]
%
\begin{lemma}
  $\bz$ is a regular value of $\bm\Psi.$
\end{lemma}
\begin{proof}
At all $(\xb,\bm\sigma)$ zeros of $\bm\Psi,$ the Jacobian matrix of
$\bm\Psi$ has full rank $n$. Indeed, indexing columns 
by $X_1,\dots,X_n,S_1,\dots,S_{i-1}$, this matrix is equal to
\[
\left[ 
\begin{array}{cc}
\bI_{i-1}\hspace{7mm} \bz_{(i-1)\times (n-i+1)}&\hspace{-10mm}-\bI_{i-1}\\
\jac_{\xb}\left(f,\frac{\pa
  f}{\pa X_{i+1}},\hdots,\frac{\pa f}{\pa X_n}\right)&\bz_{(n-i+1)\times (i-1)}
\end{array}
\right].
\] 
Since the Jacobian of $f,\frac{\pa f}{\pa X_{i+1}},\hdots,\frac{\pa
  f}{\pa X_n}$ at $\xb$ is non-zero (by $\textbf{H}_i$), the entire
matrix must have full rank $n$. Thus,  $\bz$ is a regular value of $\bm\Phi.$
\end{proof}

Since all polynomials defining $\bm\Psi$ have degree at most $d$, it
follows by Proposition~\ref{prop:weak_t} that there exists a non-zero
polynomial $\Xi_i$ in $\C[S_1,\dots,S_{i-1}]$ of degree at most
$d^{2n},$ with the following property: at any root $\xb$ of
$(X_1-\sigma_1,\dots,X_{i-1}-\sigma_{i-1},f, {\pa f}/{\pa
  X_{i+1}},\dots,{\pa f}/{\pa X_n})$, the Jacobian matrix of these
equations has rank $n$. Theorem~\ref{theo:Hp} is proved.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Property ${\bf H}_i(2)$: Noether position}\label{sec:Hi2}

Throughout this section, $f$ and $i \in \{1,\hdots,n\}$ are fixed. We
prove that there exists a hypersurface $\D_{i} \subset \C^{n\times
  n}$ of degree at most \td{} such that if $\mA$ is not in $\D_{i}$,
then $\mA$ is invertible and satisfies both conditions in
$\textbf{H}_i$.

Consider again the $n\times n$ matrix of indeterminates
$\A=(\A_{j,k})_{1 \le j,k \le n}$ and the field $\C(\A)$,
and define $f^{\A} \in \C(\A)[X_1,\dots,X_n]$.  Since $i$ is fixed, to
simplify notation, let $\I^\A$ denote the following polynomials in
$\C(\A)[X_1,\dots,X_n]$:
$$\I(\pi_i,f^\A)= \big (f^\A, {\pa f^\A}/{\pa X_{i+1}},\dots,{\pa
  f^\A}/{\pa X_n}) \big ),$$ and let $W^\A$ denote their zero-set,
that is, $W(\pi_i,V(f^\A)).$ In Section~\ref{ssec:Hi1}, we saw that
$f^\A$ satisfies $\textbf{H}_i(1)$, so that $\I^\A$ defines a
radical ideal, and $W^\A$ is equidimensional of dimension $i-1$. We
now point out that $f^\A$ also satisfies $\textbf{H}_i(2)$.


\begin{lemma} 
 The extension $$\C(\A)[X_1,\dots,X_{i-1}]\rightarrow
 \C(\A)[X_1,\dots,X_n]/\I^{\A}$$ is integral.
\end{lemma}
\begin{proof}
  Let $(\fp_\ell)_{1 \le \ell \leq L}$ be the prime components of
  the radical ideal $\I^\A$. By \cite[Proposition 1]{EMP}, for all
  $\ell$,
  \[
    \C(\A)[X_1,\dots,X_{i-1}]\rightarrow\C(\A)[X_1,\dots,X_n]/\fp_\ell
  \] 
  is integral. Therefore polynomials
  $q_{\ell,j}\in\C(\A)[X_1,\dots,X_{i-1},X_j]$ exist, all monic in
  $X_j$, with $q_{\ell,j}(X_j)\in \fp_\ell$ for each $j$ in
  $\{i,\hdots,n\}.$ Thence, $ Q_{j} := \prod_{1 \le \ell\le L}
  q_{\ell,j}$ is monic in $X_j$ and satisfies $ Q_{j} \in \I^\A$, for
  each $j \in \{i,\hdots,n\}.$ This proves our claim.
\end{proof}

\noindent
If $P$ is any polynomial in $\C(\frak A)[X_1,\dots,X_n]$, we will let
$D \in \C[\frak A]$ be the minimal common denominator of all its
coefficients, and we will write $\overline P := D P$, so that
$\overline P$ is in $\C[\A,X_1,\dots,X_{i-1},X_n]$.


\begin{lemma} 
  For $j=i,\dots,n$, there exists $P_j$ in $
  \C(\A)[X_1,\dots,X_{i-1},X_j]$, monic in $X_j$, with $\pjb$ in
  $\I^\A$, and such that $\deg(\pjb)\leq (2d)^{n}.$
\end{lemma} 
\begin{proof}
  We let $\frak L^\A$ denote the extension of $\I^\A$ given by $\frak
  L^\A:=\I^\A\cdot \C(\frak A, X_1,\dots,X_{i-1})[X_i,\dots,X_n]$. Then,
  \begin{equation}\label{eq:1}
    \C(\frak A, X_1,\dots,X_{i-1}) \to \C(\frak A,
    X_1,\dots,X_{i-1})[X_i,\dots,X_n]/\frak L^\A
  \end{equation}
  is an algebraic extension. On the other hand, 
  the previous lemma states that 
  \begin{equation}\label{eq:2}
    \C(\A)[X_1,\dots,X_{i-1}]\rightarrow
    \C(\A)[X_1,\dots,X_n]/\I^{\A}  
  \end{equation}
  is integral; from this, Proposition~3.3.1 in~\cite{GiHeSa93} implies
  that it is actually a free module. Any basis of the latter is also a
  basis of~\eqref{eq:1}; as a consequence, for $j$ in $i,\dots,n$, the
  characteristic polynomials of $X_j$ in~\eqref{eq:1} or~\eqref{eq:2}
  are the same. Let $P_j$ be the minimal polynomial of $X_j$
  in~\eqref{eq:1}. The previous discussion implies that the
  characteristic polynomial $\chi_j$ of $X_j$ in~\eqref{eq:1}, and
  thus also $P_j$, are in $\C(\A)[X_1,\dots,X_{i-1},X_j]$ and monic in
  $X_j$.

  By definition, $\chi_{j}$ is in $\frak I^\A$ and since there exists
  an integer $k$ such that $\chi_j$ divides $P_j{}^k$ in
  $\C(\A)[X_1,\dots,X_{i-1}][X_j]$, $P_j{}^k$ is in $\frak
  I^\A$. Since the latter ideal is radical, we conclude that $P_{j}$
  is in $\frak I^\A$. This implies that $\pjb$ is in $\frak I^\A$ as
  well.

  Now, consider the polynomials $f^\A, {\pa f^\A}/{\pa
    X_{i+1}}, \dots, {\pa f^\A}/{\pa X_n}$ in $\C[\A,X_1,\dots,X_n]$,
  let $\frak W$ be their zero-set, and let $\deg(\frak W)$ be its
  degree, in the sense of~\cite{H}. Proposition~1 in~\cite{CGR}
  implies that $\pjb$ has degree at most $\deg(\frak W)$. Since all
  polynomials defining $\frak W$, seen in $\C[\A,X_1,\dots,X_n]$, have
  degree at most $2d$, the B\'ezout inequality of~\cite{H} gives
  $\deg(\pjb) \le (2d)^{n-i+1} \le (2d)^n$.
\end{proof}

Our next step is to give degree bounds on the coefficients appearing
in the membership equality $\pjb \in\I^\A$. This is done using
Rabinovicz's trick. Let $T$ be a new variable; applying the
Nullstellensatz in $\C(\A)[X_1,\dots,X_n,T]$, and clearing
denominators, we obtain the existence of $\alpha_j$ in
$\C[\A]-\{0\}$ and $ C_{j,\ell},B_j$ in
$\C[\A][X_1,\dots,X_n][T]$, such that
\begin{align}\label{eq:nullst}
\alpha_j = \sum_{\ell=1}^{n-i+1} C_{j,\ell} G_\ell + B_j (1-\pjb T),\ \  G_\ell \in 
\left\{ 
f^\A,\frac{\partial f^\A}{\partial X_{i+1}},\hdots,\frac{\partial f^\A}{\partial X_n}
\right\}.
\end{align}

Let us then define 
$$\D_{i}:=\D_{i,1} \alpha_i \cdots \alpha_n D_i \cdots D_n,$$ where
$\D_{i,1}$ was defined in Section~\ref{ssec:Hi1} and for all $j$,
$\alpha_j$ is as above and $D_j$ is the leading coefficient of $\pjb$
with respect to $X_j$. Thus, $\D_{i}$ is a non-zero polynomial in
$\C[\A]$; we will estimate its degree below.

\begin{lemma}
  Suppose that $\mA \in \C^{n\times n}$ does not cancel $\D_{i}$. Then
  $f^\mA$ satisfies ${\bf H}_i$.
\end{lemma}
\begin{proof}
  By assumption, $\D_{i,1}(\mA)$ is non-zero, so that $\mA$ is
  invertible and $f^\mA$ satisfies ${\bf H}_i(1)$. In particular, the
  ideal $\I(i, f^\mA)$ is radical, and its zero-set
  $W(\pi_i,V(f^\mA))$ is either empty or $(i-1)$-equidimensional. If
  it is empty, we are done.

  Otherwise, for $j=i,\dots,n$, evaluate all indeterminates in $\A$ at the
  corresponding entries of $\mA$ in~\eqref{eq:nullst}. This gives us
  an equality in $\C[X_1,\dots,X_n,T]$ of the form
  \begin{align*}
    a_j = \sum_{\ell=1}^{n-i+1} c_{j,\ell} g_\ell + b_j (1-p_j T),\ \  g_\ell \in 
    \left\{ 
      f^\mA,\frac{\partial f^\mA}{\partial X_{i+1}},\hdots,\frac{\partial f^\mA}{\partial X_n}
    \right\},
  \end{align*}
  for $a_j$ in $\C$, polynomials $c_{j,\ell}$ and $b_j$ in
  $\C[X_1,\dots,X_n,T]$ and $p_j$ in
  $\C[X_1,\dots,X_{i-1},X_j]$. Since neither $\alpha_j$ nor $D_j$
  vanish at $\mA$, $a_j$ is non-zero and the leading coefficient of
  $p_j$ in $X_j$ is a non-zero constant.

  The conclusion is now routine. Replace $T$ by $1/p_j$ in the
  previous equality; after clearing denominators, this gives a
  membership equality of the form $p_j{}^k \in \I(i, f^\mA)$, for some
  integer $k \ge 1$ (we cannot have $k=0$, since we assumed that
  $W(\pi_i,V(f^\mA))$ is not empty). Since $\I(i, f^\mA)$ is radical,
  $p_j$ is in $\I(i, f^\mA)$. Repeating this for all $j$ proves that 
  $\C[X_1,\dots,X_{i-1}]\rightarrow\C[X_1,\dots,X_n]/\I(i, f^\mA)$
  is integral.
\end{proof}

To estimate the degree of $\D_{i}$, what remains is to give an upper
bound on the degree of $\alpha_i,\dots,\alpha_n$. This will come as an
application of the effective Nullstellensatz given in~\cite{EN}, for
which we first need to determine degree bounds, separately in $\Xb,T$
and $\A,$ of the polynomials in the membership relationship. We have
\begin{align*}
\deg_{\Xb,T}\left\{ 
f^\A,\frac{\partial f^\A}{\partial X_{i+1}},\hdots,\frac{\partial f^\A}{\partial X_n}
\right\}&\leq d,\\
\deg_{\A}  
\left\{ 
f^\A,\frac{\partial f^\A}{\partial X_{i+1}},\hdots,\frac{\partial f^\A}{\partial X_n}
\right\}& \leq d,\\
\deg_{\Xb,T}(1-T\pjb) &\leq (2d)^n +1,\\
\deg_{\A}(1-T\pjb)& \leq (2d)^n.
\end{align*}
For each $j \in \{i,\hdots,n\},$ a direct application of \cite[Theorem
0.5]{EN}, gives $\deg(\alpha_j) \le (n+1)d^n((2d)^n+1)$; we will use
the slightly less precise bound $\deg(\alpha_j) \le 2n(2d)^{2n}$.


We saw in Section~\ref{ssec:Hi1} that $\D_{i,1}$ has degree at most
$2nd^{2n}$, and all $D_j$'s have degree at most $(2d)^n$. This gives
the upper bound
$$\deg(\D_i) \le 2nd^{2n} + 2n^2(2d)^{2n} + n(2d)^n \le 6n^2 (2d)^{2n}.$$
This completes the proof of Theorem~\ref{theo:gen}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Bit complexity}
Recall Theorem 1.1:   Suppose that $f\in\ZZ[X_1\hdots,X_n]$ is squarefree, satisfies
  $\deg(f) \leq d, \htt(f) \leq s$, and that $V(f) \subset \C^n$ is
  smooth.  Assume also that $f$ is given by a straight-line program
  $\Gamma$ of size $L$ with integer constants of height at most $b.$

  There exists a randomized algorithm that takes $\Gamma, d,$ and $s$
  as input and produces a zero-dimensional parameterization of a set
  that contains at least one point in each connected component of
  $V(f) \cap \R^n$. 
  
  As part of the randomization, the algorithm chooses a set 
  \[
  S := \{1,2,\hdots,2\epsilon^{-1}3n^2(2d)^{3n}\}
  \]
  from which to sample from. 
  
  With probability at least $1-\epsilon$, the output is correct. Otherwise, the algorithm either returns a proper subset of the points or FAIL. In any case, the algorithm uses
  \[
  O^{\sim}(nk(Lb+d^{2n}(s + \log 1/\epsilon+d)(L+d)\log(s + \log 1/\epsilon)))
  \]
  bit operations, with $k \geq 1+\lg n + \lg(1/\epsilon)$. The polynomials in
  the output have degree at most $d^n,$ and height 
  \[
  O^{\sim}((s+\lg 1/\epsilon + d)d^n)
  =O^{\sim}((s+\lg 1/\epsilon)d^{n+1}).
  \]
%
\subsection{The Algorithm}
%
For a matrix $A \in \GL(n,\Q),$ let 
\[
Y_i = X_i^{A} = [b_i] \cdot \bbm X_1\\ \vdots \\ X_n \ebm, 
\]
where $b_i$ is the i-th row of $A^{-1}$.
%
\begin{algorithm}[hbt!]
\KwIn{a straight line program $\Gamma$ that computes $f \in \Q[X_1,\hdots,X_n],$ and $d=\deg(f)$}
\KwOut{$n$ zero-dimensional parameterizations, the union of which includes at least one point in each connected component of $V(f) \cap \R^n$}
\nl Take  $S := \{1,2,\hdots,2\epsilon^{-1}3n^2(2d)^{3n}\}$
 and randomly choose $A \in S^{n^2}$, and  $\sigma_{n-1}=(\sigma_1,\hdots,\sigma_{n-1}) \in S^{n-1}$\;
\nl Compute $f$ and apply the change of variables to obtain $f(A x)=f^A(x)$\;
\nl Use \cite{partialDerComputation} to compute the partial derivatives $\frac{\pa f^A}{\pa X_{i+1}},\hdots,\frac{\pa f^A}{\pa X_n}$\;
    \caption{{Main Algorithm} \label{}}
\nl \For{$i\gets1$ \KwTo $n$}{
\nl Run \cite[Algorithm 2]{SH} $k \geq 1+\lg n + \lg(1/\epsilon)$ times with input (state this in terms of straight line programs?)
$\{Y_1-\sigma_1,\hdots,Y_{i-1}-\sigma_{i-1},f^A,\frac{\pa f^A}{\pa X_{i+1}},\hdots,\frac{\pa f^A}{\pa X_n} \} \textrm{ and } d$\;
\nl Let $\mathscr{Q}_i$ be the highest cardinality zero-dimensional parameterization returned in step 5 \;
} 
\nl \Return $[\mathscr{Q}_1,\hdots,\mathscr{Q}_n]$.
\end{algorithm}

%
\subsection{Proof of Theorem 1.1}
%
\textbf{Bit operation cost:} The following lists the costs for each step of Algorithm 1:
%
\begin{enumerate}
    \item We defined $S = \{1,2,\hdots,2\epsilon^{-1}3n^2(2d)^{3n}\}$ and therefore the height of $a_{i,j} \in S$ is at most 
    \[
    \log 1/{\epsilon} + \log(3n^2(2d)^{2n}) = O^{\sim}(\log 1/{\epsilon}).
    \]
    \item 
    \begin{enumerate}[label=\roman*.]
        \item $O(L)$ operations are required to compute $f$ from its straight line program $\Gamma.$
        \item After applying the change of variables obtaining $f(A x)=f^A(x)$ the height grows at most by a factor of
        \begin{align*}
        \log(n!\cdot \max_{\frac{1\leq i\leq n}{1\leq j\leq n}}\{a_{ij}\}) &= 
        O^{\sim}(n\log n + \log 1/{\epsilon})\\
        &= O^{\sim}(\log 1/{\epsilon}).
        \end{align*}
    \end{enumerate}
    \item After computing the partial derivatives the height grows by at most another factor of $\log d$. Furthermore, preparing the straight line program for the gradient of $f$ does not introduce large integers. The integers in $\grad (f)$ are of the same magnitude as in $\Gamma$.
    \item 
    After applying \cite[Algorithm 2]{SH} $kn$ times, we obtain the
    following upper bound on the total number of bit operations required by the algorithm:
  \[
  O^{\sim}(nk(Lb+d^{2n}(s + \log 1/\epsilon+d)(L+d)\log(s + \log 1/\epsilon)))
  \]
    where it also follows from \cite[Algorithm 2]{SH} that the polynomials in the output have degree at most $d^n,$ and height at most
  \[
  O^{\sim}((s+\lg 1/\epsilon + d)d^n)
  =O^{\sim}((s+\lg 1/\epsilon)d^{n+1}).
  \]
\end{enumerate}
%
\par \noindent 
\textbf{Probability of success:} By Theorem 2.1, there exists $\Delta_i \in \C[\A]$ with $\deg \Delta_i \leq 2n^2(2d)^{3n}.$ By Theorem 2.2, there exists $\Xi_i \subset \C[\A]$ with $\deg \Xi_i \leq d^{2n}.$ Take $\Delta =  \prod_{i=1}^n\Delta_i  \Xi_i $ so that 
%
\begin{align*}
    \deg \Delta &\leq \sum_{i=1}^n (\deg \Delta_i + \deg \Xi_i)\\
    &\leq 2n^2(2d)^{3n} + nd^{2n}\\
    &\leq 3n^2(2d)^{3n}, 
\end{align*}
%
and note that, for $A \in \C^{n \times n}$ that does not cancel $\Delta,$  $\mA$ is then invertible and $f^\mA$ satisfies $\textbf{H}_i$ and $\textbf{H}_i^{'}$ for all $i \in \{1,\hdots,n\}.$
  
Let $\mathscr{E}$ be the event that, the parameterizations $[\mathscr{Q}_1,\hdots,\mathscr{Q}_n]$ returned in step 7 of Algorithm 1 contain all points and are correct. Then, 
\begin{align*}
\pr[\textrm{success}] = \pr[A \not\in \Delta] \times \pr[\mathscr{E}~|~A \not\in \Delta].  
\end{align*}
By construction of $S$,
\[
\pr[A \not\in \Delta] = 1-\pr[A \in \Delta] \geq
1-\epsilon/2.
\]
Now set $k = \lg(2n/\epsilon)$ so that 
\[
(1-2^{-k})^n = (1 - \epsilon/(2n))^n \geq 1 - \epsilon/2,
\]
by Bernoulli's inequality. Therefore, 
\begin{align*}
\pr[\textrm{success}] &\geq  (1-\epsilon/2)\pr[\mathscr{E}~|~A \not\in \Delta]\\
&\geq (1-\epsilon/2)(1-(11/32)^k)^n\\
& \geq (1-\epsilon/2)(1-2^{-k})^n \\
& \geq (1-\epsilon/2)(1-\epsilon/2)\\
& = 1 - \epsilon + \epsilon^2/4 \geq 1- \epsilon.
\end{align*}
%%
%% The next two lines define the bibliography style to be used, and
%% the bibliography file.
\bibliographystyle{ACM-Reference-Format}
\bibliography{sample-base}
%%
\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
